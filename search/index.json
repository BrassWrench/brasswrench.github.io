[{"content":" 操作系统引论 操作系统（Operating System，OS） 是配置在计算机硬件上的第一层软件，是对硬件系统的首次扩充，其主要作用是管理好这些设备，提高它们的利用率和系统的吞吐量，并为用户和应用程序提供一个简单的接口，便于用户使用。OS是现代计算机系统中最基本和最重要的系统软件，而其他的诸如编译程序、数据库管理系统等系统软件，以及大量的应用软件，都直接依赖于操作系统的支持，取得它所提供的服务。事实上OS已经成为现代计算机系统、多处理机系统、计算机网络中都必须配置的系统软件。\n操作系统的目标和作用 操作系统的目标与应用环境有关。例如在查询系统中所用的OS，希望能提供良好的人机交互性；对于工业控制、武器控制以及多媒体环境下的OS，要求其具有实时性。而对于微机上配置的OS，则更看重的是其使用的方便性。\n操作系统的目标 在计算机系统上配置操作系统，其主要目标是：方便性、有效性、可扩充性和开放性。\n方便性 一个未配置OS的计算机系统是极难使用的。用户如果想直接在计算机硬件（裸机）上运行自己的程序，就必须用机器语言书写；但是如果配置了OS，系统就可以使用编译命令将用户采用高级语言书写的程序翻译成机器代码，或直接通过OS所提供的各种命令操纵计算机系统，极大地方便了用户，使计算机变得易学易用。\n有效性 有效性所包含的第一层含义是提高系统资源的利用率。在早期未配置OS的计算机系统中，诸如处理机、IO设备等都经常处于空闲状态，各种资源无法得到充分利用，所以在当时，提高系统资源利用率是推动OS发展最主要的动力。有效性的另一层含义是提高系统的吞吐量。OS可以通过合理地组织计算机的工作流程，加速程序的运行，缩短程序的运行周期，从而提高了系统的吞吐量。\n可扩充性 为适应计算机硬件、体系结构以及计算机应用发展的要求，OS必须具有很好的可扩充性。可扩充性的好坏与OS的结构有精密的联系，由此推动了OS结构的不断发展。从早期的无结构发展成模块化结构，进而又发展成层次化结构，近年来OS已广泛采用了微内核结构。微内核结构能方便地增添新的功能和模块，以及对原有的功能和模块进行修改，具有良好的可扩充性。\n开放性 所谓开放性，是指系统能遵循世界标准规范，特别是遵循开放系统互连OSI国际标准。事实上，凡遵循国际标准所开发的硬件和软件，都能彼此兼容，方便地实现互连。开放性已称为20世纪90年代以后计算机技术的一个核心问题，也是衡量一个新推出的系统或软件能否被广泛应用的至关重要的因素。\n操作系统的作用 操作系统在计算机系统中所起的作用，可以从用户、资源管理及资源抽象等多个不同的角度来进行分析和讨论。\nOS作为用户与计算机硬件系统之间的接口 OS作为用户与计算机硬件系统之间的接口的含义是：OS处于用户与计算机硬件系统之间，用户通过OS来使用计算机系统。或者说，用户在OS帮助下能够方便、快捷、可靠地操纵计算机硬件和运行自己的程序。图1是OS作为接口的示意图。由图可看出，用户可通过三种方式使用计算机，即通过命令方式、系统调用方式和图标\u0026mdash;窗口方式来实现与操作系统的通信，并取得它的服务。\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e 用户 应用程序 命令 系统调用 图标—窗口 操作系统 计算机硬件 图1 OS作为接口的示意图\nOS作为计算机系统资源的管理者 ","date":"2024-09-19T22:28:10+08:00","permalink":"https://www.brasswrench.cn/posts/computer_science/operating_system/introduction_to_operating_system/","title":"操作系统（一）：操作系统引论"},{"content":" 马尔可夫过程 引言 有一类随机过程，它具备所谓的“无后效性”(马尔可夫性)，即，要确定过程将来的状态，知道它此刻的情况就足够了，并不需要对它以往的情况的认识，这类过程称为马尔可夫过程。本文将介绍马尔可夫过程中最简单的两种类型：离散时间马尔可夫链（简称马氏链）及连续时间的马尔可夫链。\n基本概念 马尔可夫链的定义 马尔可夫链 定义1：给定随机过程 $\\{X_n,n=0,1,2,\\cdots\\}$ ，若它只取有限或可列个值 $E_0,E_1,E_2,\\cdots$（我们以 $\\{0,1,2,\\cdots\\}$ 来标记 $E_0,E_1,E_2$ 并称他们是过程的状态， $\\{0,1,2\\cdots\\}$ 或者其子集记为 $S$ ，称为过程的状态空间）。若对 $\\{X_n,n=0,1,2,\\cdots\\}$ （一般就认为它的状态是非负整数）和任意的 $\\;n\\ge0\\;$ 及状态 $i,j,i_0,i_1\\cdots,i_{n-1}$ ，有\n$$ \\begin{aligned} \u0026P\\{X_{n+1}=j\\;|\\;X_0=i_0,X_1=i_1,X_2=i_2,\\cdots,X_{n-1}=i_{n-1},X_n=i\\}\\\\[5pt] =\u0026P\\{X_{n+1}=j\\;|\\;X_n=i\\} \\end{aligned} \\tag{1} $$ 则称随机过程 $\\{X_n,n=0,1,2,\\cdots\\}$ 为马尔可夫链。\n马尔可夫性 式1刻画了马尔可夫链的特性，故称为马尔可夫性。\n转移概率 转移概率 定义2：称式1中的条件概率 $P\\{X_{n+1}=j\\;|\\;X_n=i\\}$ 为马尔可夫链 $\\{X_n,n=0,1,2,\\cdots\\}$ 的一步转移概率，简称转移概率。\n一般情况下，转移概率与状态$i,j$和时刻$n$有关。\n时齐马尔可夫链 定义3：当马尔可夫链的转移概率只与状态 $i,j$ 有关，而与 $n$ 无关时，称马尔可夫链为时齐的，并记 $p_{ij}=P\\{X_{n+1}=j\\;|\\;X_n=i\\}(n \\ge 0)$ ；否则，就称之为非时齐的。\n本文只讨论时齐马尔可夫链并将其简称为马尔可夫链。\n有限链和无限链 当马尔可夫链的状态为有限时，成为有限链，否则成为无限链。但无论状态有限还是无限，我们都可以将 $p_{ij}(i,j\\in S)$ 排成一个矩阵的形式，令\n$$ \\mathbf{P}=(p_{ij})= \\begin{pmatrix} p_{00} \u0026 p_{01} \u0026 p_{02} \u0026 p_{03} \u0026 \\cdots \\\\ p_{10} \u0026 p_{11} \u0026 p_{12} \u0026 p_{13} \u0026 \\cdots \\\\ p_{20} \u0026 p_{21} \u0026 p_{22} \u0026 p_{23} \u0026 \\cdots \\\\ p_{30} \u0026 p_{31} \u0026 p_{32} \u0026 p_{33} \u0026 \\cdots \\\\ \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\ddots \\\\ \\end{pmatrix} \\tag{2} $$ 则称 $\\mathbf{P}$ 为转移概率矩阵，一般称为转移矩阵。容易看出 $p_{ij}(i,j\\in S)$ 有性质\n$$ \\begin{aligned} \u0026(1)\\; p_{ij} \\ge 0, \\;i,j\\in S \\\\[5pt] \u0026(2)\\; \\sum_{j \\in S}{p_{ij}} = 1, \\forall i \\in S \\end{aligned} \\tag{3} $$n步转移概率与C-K方程 n步转移概率 定义4：称条件概率\n$$ p_{ij}^{(n)}=P\\{X_{m+n}=j\\;|\\;X_m=i\\}\\quad i,j\\in S,m \\ge 0, n \\ge 1 \\tag{4} $$为马尔可夫链的n步转移概率，相应地称 $\\mathbf{P}^{(n)}=(p_{ij}^{(n)})$ 为n步转移矩阵。\n当 $n=1$ 时， $p_{ij}^{(1)}=p_{ij}$ ， $\\mathbf{P}^{(1)}=\\mathbf{P}$ 。此外规定\n$$ p_{ij}^{(0)}= \\begin{cases} 0, \\quad i \\ne j\\\\[5pt] 1, \\quad i=j \\end{cases} \\tag{5} $$ 显然，n步转移概率 $p_{ij}^{(n)}$ 指的就是系统从状态 $i$ 经过 $n$ 步后转移到了 $j$ 的概率，它对中间的 $n-1$ 步转移经过的状态无要求。下面的定理给出了 $p_{ij}^{(n)}$ 和 $p_{ij}$ 的关系。\nC-K方程 定理1（Chapman-Kolmogorov方程，简称C-K方程）：对一切 $n,m \\ge 0$ ， $i,j \\in S$ 有\n①\n$$ p_{ij}^{(m+n)}=\\sum_{k \\in S}{p_{ik}^{(m)}}p_{kj}^{(n)} \\tag{6} $$ ② $$ \\mathbf{P}^{(n)}=\\mathbf{P} \\cdot \\mathbf{P}^{(n-1)} = \\mathbf{P} \\cdot \\mathbf{P} \\cdot \\mathbf{P}^{(n-2)} = \\cdots = \\mathbf{P}^n \\tag{7} $$ 证明（定理1）：由全概率公式可得\n$$ \\begin{aligned} p_{ij}^{(m+n)}\u0026=P\\{X_{m+n}=j\\;|\\;X_0=i\\}\\\\[5pt] \u0026=\\frac{P\\{X_{m+n}=j,X_0=i\\}}{P\\{X_0=i\\}}\\\\[10pt] \u0026=\\sum_{k \\in S}{\\frac{P\\{X_{m+n}=j,X_m=k,X_0=i\\}}{P\\{X_0=i\\}}}\\text{（全概率公式）}\\\\ \u0026=\\sum_{k \\in S}{\\frac{P\\{X_{m+n}=j,X_m=k,X_0=i\\}}{P\\{X_m=k,X_0=i\\}}\\frac{P\\{X_m=k,X_0=i\\}}{P\\{X_0=i\\}}}\\\\ \u0026=\\sum_{k \\in S}{P\\{X_{m+n}=j\\;|\\;X_m=k,X_0=i\\}}P\\{X_m=k\\;|\\;X_0=i\\}\\\\ \u0026=\\sum_{k \\in S}{p_{kj}^{(n)}p_{ik}^{(m)}}\\\\ \u0026=\\sum_{k \\in S}{p_{ik}^{(m)}p_{kj}^{(n)}} \\end{aligned} \\tag{8} $$ 由矩阵乘法易得②是①的矩阵形式。\n状态的分类及性质 可达、互通、类、可约 定义5：称状态 $i$ 可达状态 $j(i,j \\in S)$，若存在 $n \\ge 0$ 使得 $p_{ij}^{(n)} \\ge 0$ ，记为 $i \\rightarrow j$ 。若同时有状态 $j \\rightarrow i$ ，则称 $i$ 与 $j$ 互通，记为 $i \\leftrightarrow j$ 。\n定理2：互通是一种等价关系，即满足：\n①自反性： $i \\leftrightarrow i$ ；\n②对称性： $i \\leftrightarrow j$ ，则 $j \\leftrightarrow i$ ；\n③传递性： $i \\leftrightarrow j$ , $j \\leftrightarrow k$ ，则 $i \\leftrightarrow k$ 。\n证明（定理2）：从互通的定义可知①②是显然的，只证③。由互通定义可知，需证 $i \\rightarrow k$ 且 $k \\rightarrow i$ 。首先，由 $i \\rightarrow j$ ， $j \\rightarrow k$ 可知存在 $m$ ， $n$ 使得 $p_{ij}^{(m)}\u0026gt;0$ ， $p_{jk}^{(n)}\u0026gt;0$ 。再由C-K方程和概率的非负性可知 $p_{ik}^{(m+n)}=\\displaystyle\\sum_{l \\in S}{p_{il}^{(m)}p_{lk}^{(n)}}\\ge {p_{ij}^{(m)}p_{jk}^{(n)}}\u0026gt;0$ ，故 $i \\rightarrow k$ 。反过来同样有 $k \\rightarrow i$ ，即证 $i \\leftrightarrow k$ 。\n我们把任何两个相通状态归为一个类，由上述定理可知，同在一类的状态应该都是互通的，并且任何一个状态不能同时属于两个不同的类。\n定义6：若马尔可夫链只存在一个类，就称它是不可约的。否则称为可约的。\n周期 定义7：若集合 $\\{n|n \\ge 1,p_{ii}^{(n)} \\ge 0\\}$ ，则称它的最大公约数 $d=d(i)$ 为状态 $i$ 的周期。若 $d \\ge 1$ ，则称 $i$ 是周期的；若 $d=1$ ，则称 $i$ 是非周期的。并特别规定上述集合为空集时，称 $i$ 的周期为无穷大。\n注：虽然 $i$ 有周期 $d$ ，但并不是对所有的 $n$ ， $p_{ii}^{(nd)}$ 都大于 $0$ 。但是可以证明，当 $n$ 充分大之后一定有 $p_{ii}^{(nd)}\u0026gt;0$（见证明）。\n定理3：若状态 $i,j$ 同属一类，则 $d(i)=d(j)$ 。\n证明（定理3）：由类的定义可知 $i \\leftrightarrow j$ ，即存在 $m,n$ 使$p_{ij}^{(m)}\u0026gt;0,p_{ji}^{(n)}\u0026gt;0$。则由C-K方程和概率的非负性知 $p_{ii}^{(m+n)}=\\displaystyle\\sum_{k \\in S}{p_{ik}^{(m)}p_{ki}^{(n)}} \\ge p_{ij}^{(m)}p_{ji}^{(n)}\u0026gt;0$ 。同时对所有使得 $p_{jj}^{(s)} \u0026gt; 0$ 的 $s$ ，有\n$$ p_{ii}^{(m+s+n)}=\\sum_{k \\in S}{p_{ik}^{(m)}p_{ki}^{(s+n)}}=\\sum_{k \\in S,\\thinspace l \\in S}{p_{ik}^{(m)}p_{kl}^{(s)}p_{li}^{(n)}} \\ge p_{ij}^{(m)}p_{jj}^{(s)}p_{ji}^{(n)}\u003e0 \\tag{9} $$ 由周期的定义可知，由于 $p_{ii}^{(m+n)}\u0026gt;0$ 且 $p_{ii}^{(m+s+n)}\u0026gt;0$ ， $d(i)$ 必然同时整除 $n+m$ 和 $n+m+s$ ，因此，它也必然整除 $s$ （见整除的基本性质）。同时我们还需注意我们已经假设了 $p_{jj}^{(s)} \u0026gt; 0$ ，因此 $d(j)$ 必定也整除 $s$ 。注意 $s$ 的任意性，不妨直接令 $s=d(j)$ ，由此可得 $d(i)$ 整除 $d(j)$ 。我们把上述证明的 $i$ 和 $j$ 交换一下，就也能得到 $d(j)$ 整除 $d(i)$ ，于是 $d(i)=d(j)$ （见整除的基本性质）。\n常返 常返与非常返（瞬过） 定义8：对于任何状态 $i,j$ ，以 $f_{ij}^{(n)}$ 记从i出发经n步后首次到达 $j$ 的概率，则有\n$$ f_{ij}^{(n)}= \\begin{cases} 0 \\quad n=0 \\\\[5pt] P\\{X_n=j,X_k \\ne j(k=1,2,\\cdots ,n-1)\\;|\\; X_0=i\\} \\quad n \\ge 1 \\end{cases} \\tag{10} $$ 令 $f_{ij}=\\displaystyle\\sum_{n=1}^{\\infin}{f_{ij}^{(n)}}$ ，若 $f_{jj}=1$ ，则称状态 $j$ 为常返状态，若 $f_{jj}\u0026lt;1$ ，称 $j$ 为非常返状态或瞬过状态。\n$f_{ij}$ 的含义可由如下得出：由集合 $A_n$ 的定义 $A_n=\\{X_n=j,X_k \\ne j, k=1,2,\\cdots n-1 \\;|\\; X_0=i\\}$ 可知 $n$ 不同的时候 $A_n$ 不相交。而 $\\displaystyle\\bigcup_{n=1}^{\\infin}{A_n}$表示的事件正是总有一个 $n$ 使得过程经 $n$ 步后可从 $i$ 到达 $j$ ,那么由不相交事件概率的可加性可得：\n$$ P(\\bigcup_{n=1}^{\\infin}{A_n})=\\sum_{n=1}^{\\infin}{P(A_n)}=\\sum_{n=1}^{\\infin}f_{ij}^{(n)}=f_{ij} \\tag{11} $$ 因此 $f_{ij}$ 表示从 $i$ 出发，有限步内可以到达 $j$ 的概率。当 $i$ 为常返状态时，以概率 $1$ 从 $i$ 出发，在有限步过程将重新返回 $i$ ，而当 $i$ 为非常返状态时，若也以概率 $1$ 从 $i$ 出发，则以概率 $1-f_{ii}$ 不再回到 $i$ （即从 $i$ 滑过）。\n对于常返态 $i$ ，定义\n$$ \\mu_i=\\sum_{n=1}^{\\infin}{nf_{ii}^{(n)}} \\tag{12} $$ 表示由 $i$ 出发再返回到 $i$ 所需的平均步数（时间）。\n正常返、零常返、遍历、吸收 定义9：对于常返态 $i$ ，若 $\\mu_i\u0026lt;+\\infin$，则称 $i$ 为正常返态；若 $\\mu_i=+\\infin$ ，则称 $i$ 为零常返态。特别地，若 $i$ 正常返且是非周期的，则称之为遍历状态。若 $i$ 是遍历状态，且 $f_{ii}^{(1)}=1$，则称 $i$ 为吸收状态。此时显然 $\\mu_i=1$ 。\n若干性质证明 常返的极限判定 定理4：状态 $i$ 为常返状态当且仅当 $\\displaystyle\\sum_{n=0}^{\\infin}{p_{ii}^{(n)}}=+\\infin$ 。状态 $i$ 为非常返状态时\n$$ \\sum_{n=0}^{(\\infin)}{p_{ii}^{(n)}}=\\frac{1}{1-f_{ii}} \\tag{13} $$ 因而此时有 $\\lim\\limits_{n \\rightarrow \\infin}p_{ii}^{(n)}=0$ 。\n为了证明定理4，我们需要先证明结论1和引理1。\n结论1：对任意状态 $i,j$ ，有\n$$ f_{ij}^{(l+1)}=\\sum_{k \\ne j,\\thinspace k \\in S}{f_{ik}^{(1)}f_{kj}^{(l)}} \\tag{14} $$ 证明（结论1）：由 $f_{ij}^{(n)}$ 的定义、马尔可夫性、时齐性和全概率公式可得\n$$ \\begin{aligned} f_{ij}^{(l+1)}=\u0026P\\{X_{l+1}=j,X_m \\ne j(m=1,2,\\cdots ,l) \\;|\\; X_0=i\\}\\quad \\text{（}f_{ij}^{(n)}\\text{的定义）}\\\\[5pt] =\u0026\\sum_{k \\ne j,\\thinspace k \\in S}{P\\{X_{l+1}=j,X_m \\ne j(m=2,\\cdots ,l),X_1=k \\;|\\; X_0=i\\}}\\text{（全概率公式）}\\\\ =\u0026\\sum_{k \\ne j,\\thinspace k \\in S}{\\frac{P\\{X_{l+1}=j,X_m \\ne j(m=2,\\cdots ,l),X_1=k,X_0=i\\}}{P\\{X_0=i\\}}}\\\\ =\u0026\\sum_{k \\ne j,\\thinspace k \\in S}{\\frac{P\\{X_1=k,X_0=i\\}}{P\\{X_0=i\\}}\\frac{P\\{X_{l+1}=j,X_m \\ne j(m=2,\\cdots ,l),X_1=k,X_0=i\\}}{P\\{X_1=k,X_0=i\\}}}\\\\ =\u0026\\sum_{k \\ne j,\\thinspace k \\in S}{P\\{X_1=k\\;|\\;X_0=i\\}P\\{X_{l+1}=j,X_m \\ne j(m=2,\\cdots ,l)\\;|\\;X_1=k,X_0=i\\}}\\\\ =\u0026\\sum_{k \\ne j,\\thinspace k \\in S}{P\\{X_1=k\\;|\\;X_0=i\\}P\\{X_{l+1}=j,X_m \\ne j(m=2,\\cdots ,l)\\;|\\;X_1=k\\}}\\text{（马尔可夫性）}\\\\ =\u0026\\sum_{k \\ne j,\\thinspace k \\in S}{P\\{X_1=k\\;|\\;X_0=i\\}P\\{X_l=j,X_m \\ne j(m=1,\\cdots ,l-1)\\;|\\;X_0=k\\}}\\text{（时齐性）}\\\\ =\u0026\\sum_{k \\ne j,\\thinspace k \\in S}{f_{ik}^{(1)}f_{kj}^{(l)}} \\end{aligned} \\tag{15} $$ 引理1：对任意状态 $i,j$ 及 $1 \\le n \u0026lt; \\infin$ ，有\n$$ p_{ij}^{(n)}=\\sum_{l=1}^{n}{f_{ij}^{(l)}p_{jj}^{(n-l)}} \\tag{16} $$ 证明（引理1）：用归纳法。对 $n=1$，由 $p_{ij}^{(1)}=f_{ij}^{(1)}$，易证式(16)成立。\n假设对 $n-1$ ，已有 $p_{ij}^{(n-1)}=\\displaystyle\\sum_{l=1}^{n-1}{f_{ij}^{(l)}p_{jj}^{(n-1-l)}}$ 成立。\n当取 $n$ 时，利用C-K方程、归纳假设和结论1，可以推导出\n$$ \\begin{aligned} p_{ij}^{(n)}\u0026=\\sum_{k \\in S}{p_{ik}^{(1)}p_{kj}^{(n-1)}} \\qquad \\text{（C-K方程）}\\\\ \u0026=p_{ij}^{(1)}p_{jj}^{(n-1)}+\\sum_{k \\ne j,\\thinspace k \\in S}{p_{ik}^{(1)}p_{kj}^{(n-1)}}\\\\ \u0026=f_{ij}^{(1)}p_{jj}^{(n-1)}+\\sum_{k \\ne j,\\thinspace k \\in S}{f_{ik}^{(1)}p_{kj}^{(n-1)}} \\text{（归纳法n=1时的情况）}\\\\ \u0026=f_{ij}^{(1)}p_{jj}^{(n-1)}+\\sum_{k \\ne j,\\thinspace k \\in S}{f_{ik}^{(1)}\\bigg(\\sum_{l=1}^{n-1}{f_{kj}^{(l)}p_{jj}^{(n-1-l)}}}\\bigg) \\text{（归纳假设n-1时的情况）}\\\\ \u0026=f_{ij}^{(1)}p_{jj}^{(n-1)}+\\sum_{l=1}^{n-1}{\\bigg(\\sum_{k \\ne j,\\thinspace k \\in S}{f_{ik}^{(1)}f_{kj}^{(l)}}\\bigg)p_{jj}^{(n-1-l)}}\\\\ \u0026=f_{ij}^{(1)}p_{jj}^{(n-1)}+\\sum_{l=1}^{n-1}{f_{ij}^{(l+1)}p_{jj}^{(n-1-l)}} \\quad \\text{(引理1)}\\\\ \u0026=f_{ij}^{(1)}p_{jj}^{(n-1)}+\\sum_{l=2}^{n}{f_{ij}^{(l)}p_{jj}^{(n-l)}}\\\\ \u0026=\\sum_{l=1}^{n}{f_{ij}^{(l)}p_{jj}^{(n-l)}}\\\\ \\end{aligned} \\tag{17} $$ 现在，我们可以用引理1证明定理4。\n证明（定理4）：\n$$ \\begin{aligned} \\sum_{n=0}^{\\infin}{p_{ii}^{(n)}}=\u0026\\:p_{ii}^{(0)}+\\sum_{n=1}^{\\infin}{p_{ii}^{(n)}}\\\\ =\u0026\\:1+\\sum_{n=1}^{\\infin}\\bigg(\\sum_{l=1}^{n}{f_{ii}^{(l)}p_{ii}^{(n-l)}}\\bigg) \\quad \\text{（引理1）}\\\\ =\u0026\\:1+\\sum_{l=1}^{\\infin}\\sum_{n=l}^{\\infin}{f_{ii}^{(l)}p_{ii}^{(n-l)}}\\\\ =\u0026\\:1+\\sum_{l=1}^{\\infin}\\sum_{m=0}^{\\infin}{f_{ii}^{(l)}p_{ii}^{(m)}}\\\\ =\u0026\\:1+\\bigg(\\sum_{l=1}^{\\infin}{f_{ii}^{(l)}}\\bigg)\\bigg(\\sum_{n=0}^{\\infin}{p_{ii}^{(n)}}\\bigg)\\\\ =\u0026\\:1+f_{ii}\\bigg(\\sum_{n=0}^{\\infin}{p_{ii}^{(n)}}\\bigg) \\end{aligned} \\tag{18} $$ 左右有相同项 $\\displaystyle\\sum_{n=0}^{\\infin}{p_{ii}^{(n)}}$，则解该等式得\n$$ \\sum_{n=0}^{\\infin}{p_{ii}^{(n)}}=\\frac{1}{1-f_{ii}} \\tag{19} $$ 因此\n$$ \\sum_{n=0}^{\\infin}{p_{ii}^{(n)}}\\text{收敛}\\iff f_{ii}\u003c1\\text{；} \\sum_{n=0}^{\\infin}{p_{ii}^{(n)}}=\\infin \\iff f_{ii}=1 \\tag{20} $$常返互通则必达 引理2：若 $i \\leftrightarrow j$ 且 $i$ 为常返态，则 $f_{ji}=1$。\n证明（引理2）：用反证法。假设 $f_{ji}\u0026lt;1$ ，则从 $j$ 出发不一定能在有限步内到达 $i$ ，但是由于 $i \\rightarrow j$ ，则从 $i$ 出发一定能在有限步到达 $j$ 。这意味着从 $i$ 出发如果经过 $j$ ，将不一定能在有限步之内再回到 $i$ ，这与 $i$ 的常返性相矛盾，假设不成立。因此 $f_{ij}=1$ 。\n常返是一个类性质 定理5：常返性是一个类性质。\n证明（定理5）：先证明若 $i \\leftrightarrow j$ 则 $i,j$ 同为常返状态或非常返状态。\n由 $i \\leftrightarrow j$ 知。存在 $n, m$ 使得 $p_{ij}^{(n)}\u0026gt;0,p_{ji}^{(m)}\u0026gt;0$ ，由C-K方程和(9)式的展开技巧易得\n$$ p_{ii}^{(n+m+l)} \\ge p_{ij}^{(n)}p_{jj}^{(l)}p_{ji}^{(m)}\\\\[5pt] p_{jj}^{(n+m+l)} \\ge p_{ji}^{(n)}p_{ii}^{(l)}p_{ij}^{(m)} \\tag{21} $$ 两边求和得到\n$$ \\sum_{l=0}^{\\infin}{p_{ii}^{(n+m+l)}} \\ge \\sum_{l=0}^{\\infin}{p_{ij}^{(n)}p_{jj}^{(l)}p_{ji}^{(m)}}\\\\[5pt] \\sum_{l=0}^{\\infin}{p_{jj}^{(n+m+l)}} \\ge \\sum_{l=0}^{\\infin}{p_{ji}^{(n)}p_{ii}^{(l)}p_{ij}^{(m)}} \\tag{22} $$ 考虑到 $\\displaystyle\\sum_{l=0}^{n+m-1}{p_{ii}^{(l)}}$ 和 $\\displaystyle\\sum_{l=0}^{n+m-1}{p_{jj}^{(l)}}$ 都是有限的，那么可以把上式写成这样：\n$$ \\sum_{l=0}^{\\infin}{p_{ii}^{(l)}} - \\sum_{l=0}^{n+m-1}{p_{ii}^{(l)}} \\ge p_{ij}^{(n)}p_{ji}^{(m)}\\sum_{l=0}^{\\infin}{p_{jj}^{(l)}}\\\\[5pt] \\sum_{l=0}^{\\infin}{p_{jj}^{(l)}} - \\sum_{l=0}^{n+m-1}{p_{jj}^{(l)}} \\ge p_{ji}^{(n)}p_{ij}^{(m)}\\sum_{l=0}^{\\infin}{p_{ii}^{(l)}} \\tag{23} $$ 因此我们可以直观的看出 $\\displaystyle\\sum_{l=0}^{n+m-1}{p_{ii}^{(l)}}$ 和 $\\displaystyle\\sum_{l=0}^{n+m-1}{p_{jj}^{(l)}}$ 当中任意一个为无穷时，另一个必然也为无穷；任意一个为有限时，另一个必然也为有限。因此 $i,j$ 同为常返状态或非常返状态。故常返性是一个类性质，类中任意成员满足，则其他成员也必定满足；反之若类中任一成员不满足，则其他成员也不满足。\n其次还能证明当 $i,j$ 同为常返状态时，它们同为正常返态或零常返态。该证明见下文证明处。\n状态空间分解定理 定理6（状态空间分解定理）：任意马尔可夫链的状态空间 $S$ ，可唯一分解为有限个或可列个互不相交的子集 $D,C_1,C_2,\\cdots$ 之和，使得\n①每一个 $C_n$ 是常返状态组成的不可约闭集，$D$ 由全体非常返状态组成。。\n② $C_n$ 中的状态同类，或者全是正常返态，或者全是零常返态。它们有相同的周期且 $f_{ij}=1(i,j \\in C_n)$ 。\n③ 自 $C_n$ 中的状态出发不能到达 $D$ 中状态。\n证明（定理6）：设 $C$ 为全体常返状态组成的集合，则 $D=S-C$ 为非常返状态的全体组成的集合。注意到定义在 $C$ 上的互通是一种等价关系，由等价关系与集合的划分可知， $C$ 可以按互通关系划分为 $C_1 \\bigcup C_2 \\bigcup \\dots$ ，其中每一个 $C_n$ 是由同一类常返状态组成的不可约的闭集。因此 $S=D \\bigcup C_1 \\bigcup C_2 \\bigcup \\dots$ 。定理假设和①证毕。由定理5可知 $C_n$ 中的状态都是同类型的（正常返或零常返），由定理3可知 $C_n$ 中的状态都有相同的周期，由引理2可知 $C_n$ 中的状态都满足 $f_{ij}=1(i,j \\in C_n)$ 。②证毕。对于③，可用反证法证明。假设 $C_n$ 中的状态 $i$ 可以到达 $D$ 中的状态 $j$ ，由于 $i$ 是常返的，状态在到达 $j$ 后必定还会再返回 $i$ ，而后再由假设，状态还可能继续回到 $j$ 。因此，状态从 $j$ 出发后再次返回 $j$ 的情况是可能出现的，这与 $j$ 是非常返态相矛盾，因此假设不成立。故 $C_n$ 中的状态 $i$ 不可到达 $D$ 中的状态 $j$ 。③证毕。定理6证毕。\n不可约马尔可夫链的转移 定理7：周期为 $d$ 的不可约马尔可夫链，其状态空间 $S$ 可唯一地分解为 $d$ 个互不相交的子集之和，即\n$$ S=\\bigcup_{r=0}^{d-1}{S_r},\\quad S_r \\bigcap S_s=\\varnothing,\\quad r \\ne S \\tag{24} $$ 且使得自 $S_r$ 任意状态出发，经 $1$ 步转移必进入 $S_{r+1}$ 中（其中 $S_d=S_0$ ）。\n证明（定理7）：先给出子集 $S_r$ 的定义：\n任意取状态 $i$，对每一个 $r=0,1,\\cdots,d-1$ ，定义集合\n$$ S_r=\\{j\\;|\\;存在n \\ge 0使得p_{ij}^{(nd+r)}\u003e0\\} \\tag{25} $$ 因为 $S$ 不可约，故 $S$ 中从 $i$ 出发一定可以遍历每一个状态，而 $nd+r(r=0,1,\\cdots,n-1)$ 可以遍历从 $i$ 出发后的每一个时间，因此所有 $S_r$ 的并集一定为 $S$ ，即 $\\displaystyle\\bigcup_{r=0}^{d-1}{S_r}=S$ 。\n接下来证明 $S_r$ 不相交。用反证法，假设存在 $S_r,S_s$ 和状态 $j$ 满足 $j \\in S_r \\bigcap S_s$ 。由 $S_r$ 的定义知存在 $n,m$ 使得 $p_{ij}^{(nd+r)}\u0026gt;0,p_{ij}^{(md+s)}\u0026gt;0$ 。又因为 $i \\leftrightarrow j$ ，故存在 $h$ 使得 $p_{ji}^{(h)}\u0026gt;0$ ，于是由C-K方程和和(9)式的展开技巧可得：\n$$ p_{ii}^{(nd+r+h)} \\ge p_{ij}^{(nd+r)}p_{ji}^{(h)}\u003e0\\\\[5pt] p_{ii}^{(md+s+h)} \\ge p_{ij}^{(md+s)}p_{ji}^{(h)}\u003e0 \\tag{26} $$ 由周期的定义可知 $nd+r+h$ 和 $md+s+h$ 都可以被 $d$ 整除。省去前面的 $n$ 和 $m$ 可得 $r+h$ 和 $s+h$ 都可被 $d$ 整除。从而其差 $(r+h)-(s+h)=r-s$ 都能被 $d$ 整除(见整除的基本性质)。但是 $0 \\le r \\le d-1,0 \\le s \\le d-1$ ，故 $0 \\le r-s \\le d-1$ ，因此 $r-s$ 只能为 $0$ ，也就是 $r=s$ 。故 $S_r=S_s$ ，假设不成立，故 $S_r$ 不相交。\n接下来证明自 $S_r$ 任意状态出发，经 $1$ 步转移必进入 $S_{r+1}$ 中（其中 $S_d=S_0$ ）。等价于证明对任意 $j \\in S_r$ ，有 $\\displaystyle\\sum_{k \\in S_{r+1}}{p_{jk}^{(1)}}=1$ 。事实上，由 $S_r$ 的定义可知 $p_{ij}^{(nd+r)}\u0026gt;0$ 。而由 $S_r$ 的定义的定义可知对 $k \\notin S_{r+1}$ 必有 $p_{ik}^{(nd+r+1)}=0$ 。因此由C-K方程和和(9)式的展开技巧可推导：\n$$ 0=p_{ik}^{(nd+r+1)} \\ge p_{ij}^{(nd+r)}p_{jk}^{(1)}\u003e0 \\tag{27} $$ 从而 $p_{jk}^{(1)}=0$ 。于是\n$$ 1\\:=\\sum_{k \\in S}{p_{jk}}=\\sum_{k \\in S_{r+1}}{p_{jk}^{(1)}} + \\sum_{k \\notin S_{r+1}}{p_{jk}^{(1)}}=\\sum_{k \\in S_{r+1}}{p_{jk}^{(1)}} \\tag{28} $$ 最后证明分解的唯一性。等价于与证明 $\\{S_k\\}$ 与初始的 $i$ 无关。也就是，对于任意的 $i,i^\\prime$ 生成的分解 $\\{S_k\\},\\{S_k^\\prime\\}$ 必相等。\n首先，证明对于 $\\{S_k\\}$ 中的任意 ${S_r}$ ，存在 ${S_s^\\prime}$ 与其状态完全相等。首先证对所有 $j \\in S_r$ ， $j$ 都只能属于 $\\{S_k^\\prime\\}$ 中某个固定的集合。假设 $i^{\\prime}$ 满足 $i^\\prime \\in S_s$ 。由于自 $S_k$ 任意状态出发经 $1$ 步转移必进入 $S_{k+1}$ 中，所以当 $s \\le r$ 时，从 $i^{\\prime}$ 到达 $j$ 只可能通过如下过程之一：\n$$ \\begin{cases} S_s \\rightarrow S_{s+1} \\rightarrow \\cdots \\rightarrow S_r\\\\ S_s \\rightarrow S_{s+1} \\rightarrow \\cdots \\rightarrow S_r\\rightarrow S_{r+1} \\rightarrow \\cdots \\rightarrow S_{d-1} \\rightarrow S_0 \\rightarrow S_1 \\rightarrow \\cdots \\rightarrow S_r\\\\ S_s \\rightarrow S_{s+1} \\rightarrow \\cdots \\rightarrow S_r\\rightarrow \\overbrace{S_{r+1} \\rightarrow \\cdots \\rightarrow S_{d-1} \\rightarrow S_0 \\rightarrow S_1 \\rightarrow \\cdots \\rightarrow S_r}^{重复2次}\\\\ \\quad \\vdots \\end{cases} \\tag{29} $$ 也就是从 $i^{\\prime}$ 出发只能在 $r-s,r-s+d,r-s+2d,\\dots$ 步上到达 $j$ 。我们发现这刚好与 $S_{r-s}^{\\prime}$ 的定义是一致的。因此 $j \\in S_{r-s}^{\\prime}$ 。反过来讨论任意 $j^\\prime \\in S_{r-s}^{\\prime}$ 。从 $i$ 转移到 $i^\\prime$ 需要 $s$ 步，而从 $i^\\prime$ 转移到 $j^\\prime$ 需要 $r-s$ 步，因此从 $i$ 转移到 $j^\\prime$ 需要 $r$ 步，故 $j^\\prime \\in S_r$ 。故 $S_r$ 与 $S_{r-s}^\\prime$ 完全对等。\n另外当 $s \u0026gt; r$ 时，由类似的方法可以证明从 $i^{\\prime}$ 出发，只能在 $d-(s-r),2d-(s-r),\\dots$ 步到达 $j$ ，因此 $j \\in S_{d-(s-r)}^{\\prime}$ 。类似的也可证明 $S_r$ 与 $S_{d-(s-r)}^{\\prime}$ 完全对等。综上，有\n$$ \\begin{cases} S_r与S_{r-s}^{\\prime}完全对等，若r \\ge s \\\\[5pt] S_r与S_{d-(s-r)}^{\\prime}完全对等，若r \u003c s \\end{cases} \\tag{30} $$ 易证此时 $\\{S_k\\},\\{S_k^\\prime\\}$ 一一对应。故分解是唯一的。\n极限定理与不变分布 极限定理 定理8（极限定理）：若状态 $j$ 是周期为 $d$ 的常返状态，则\n$$ \\lim\\limits_{n \\rightarrow \\infin}p_{jj}^{(nd)}=\\frac{d}{\\mu_j} \\tag{31} $$ 证明（定理8）：对 $n \\ge 0$ ，令：\n$$ r_n=\\sum_{v=n+1}^{\\infin}{f_v} \\tag{32} $$ 其中 $f_v=f_{jj}^{(v)}$ 。于是\n$$ \\begin{aligned} \\sum_{n=0}^{\\infin}{r_n}=\u0026\\sum_{n=0}^{\\infin}\\sum_{v=n+1}^{\\infin}{f_v}\\\\ =\u0026(f_1+f_2+f_3+\\cdots)+(f_2+f_3+\\cdots)+(f_3+\\cdots)+\\cdots\\\\[5pt] =\u00261\\cdot f_1 + 2 \\cdot f_2 + 3 \\cdot f_3 + \\cdots\\\\ =\u0026\\sum_{n=1}^{\\infin}{nf_n}=\\mu_j \\end{aligned} \\tag{33} $$ 由 $r_n$ 定义可知 $f_n=r_{v-1}-r_v$ ，代入引理1并记 $p_v=p_{jj}^{(v)}$ 可得\n$$ p_n=p_{jj}^{(n)}=\\sum_{l=1}^{n}{f_{jj}^{(l)}p_{jj}^{(n-l)}}=-\\sum_{v=1}^{n}{(r_v-r_{v-1})p_{n-v}} \\tag{34} $$ 注意 $j$ 是常返状态，故 $r_0=1$。则上式可以写成\n$$ \\sum_{v=0}^{n}{r_vp_{n-v}}=\\sum_{v=0}^{n-1}r_vp_{n-1-v} \\tag{35} $$ 上面这个式子表示了一个很明显的结论： $\\displaystyle\\sum_{v=0}^{n}{r_vp_{n-v}}$ 的值与 $n$ 无关。因此：\n$$ \\sum_{v=0}^{n}{r_vp_{n-v}}=r_0p_0=1,\\quad n \\ge 0 \\tag{36} $$ 设\n$$ \\lambda=\\limsup\\limits_{n \\rightarrow \\infin}p_{nd} \\tag{37} $$ 注意当 $k$ 非 $d$ 的倍数的时候 $p_k=0$ ，而 $p_{nd} \\ge 0$ ，根据上极限的定义可知：\n$$ \\limsup\\limits_{k \\rightarrow \\infin}p_k=\\limsup\\limits_{n \\rightarrow \\infin}p_{nd}=\\lambda \\tag{38} $$ 因此再由上极限的定义，必然存在一个子列的极限等于 $\\lambda$ 。再次注意 $k$ 非 $d$ 的倍数的时候 $p_k=0$ ，因此这个子序列可以在 $\\{nd\\}$ 中取。从而存在 $\\{n\\}$ 的子列 $\\{n_m\\},n_m \\rightarrow \\infin$ 使得\n$$ \\lambda=\\lim\\limits_{m \\rightarrow \\infin}{p_{n_md}} \\tag{39} $$ 任取 $s$ 使得 $f_s\u0026gt;0$ ，由引理1和下极限的性质可得\n$$ \\begin{aligned} \\lambda=\u0026\\liminf\\limits_{m \\rightarrow \\infin}p_{n_md}=\\liminf\\limits_{m \\rightarrow \\infin}p_{jj}^{(n_md)}=\\liminf\\limits_{m \\rightarrow \\infin}\\sum_{v=1}^{n_md}f_{jj}^{(v)}p_{jj}^{(n_md-v)}\\\\ =\u0026\\liminf\\limits_{m \\rightarrow \\infin}\\sum_{v=1}^{n_md}f_{v}p_{n_md-v}=\\liminf\\limits_{m \\rightarrow \\infin}\\bigg(f_sp_{n_md-s}+\\sum_{v=1,v \\ne s}^{n_md}f_{v}p_{n_md-v}\\bigg)\\\\ \\le\u0026\\liminf\\limits_{m \\rightarrow \\infin}f_sp_{n_md-s}+\\liminf\\limits_{m \\rightarrow \\infin}\\bigg(\\sum_{v=1,v \\ne s}^{n_md}f_{v}p_{n_md-v}\\bigg)\\quad\\text{（}\\liminf\\limits_{n \\rightarrow \\infin}(a_n+b_n)\\le\\liminf\\limits_{n \\rightarrow \\infin}a_n+\\liminf\\limits_{n \\rightarrow \\infin}b_n\\text{）} \\end{aligned} \\tag{40} $$ 由概率的非负性和上下极限的定义和性质和可推导出\n$$ \\begin{aligned} \\liminf\\limits_{m \\rightarrow \\infin}\\sum_{v=1,v \\ne s}^{n_md}f_{v}p_{n_md-v}\\le\u0026\\liminf\\limits_{m \\rightarrow \\infin}\\sum_{v=1,v \\ne s}^{\\infin}f_{v}p_{n_md-v}\\quad\\text{（概率的非负性）}\\\\ \\le\u0026\\sum_{v=1,v \\ne s}^{\\infin}\\liminf\\limits_{m \\rightarrow \\infin}f_{v}p_{n_md-v}\\quad\\text{（}\\liminf\\limits_{n \\rightarrow \\infin}(a_n+b_n)\\le\\liminf\\limits_{n \\rightarrow \\infin}a_n+\\liminf\\limits_{n \\rightarrow \\infin}b_n\\text{）}\\\\ \\le\u0026\\sum_{v=1,v \\ne s}^{\\infin}\\liminf\\limits_{m \\rightarrow \\infin}f_{v}\\limsup\\limits_{m \\rightarrow \\infin}p_{n_md-v}\\quad\\text{（}\\liminf\\limits_{n \\rightarrow \\infin}a_nb_n\\le\\liminf\\limits_{n \\rightarrow \\infin}a_n\\limsup\\limits_{n \\rightarrow \\infin}b_n\\text{）}\\\\ =\u0026\\sum_{v=1,v \\ne s}^{\\infin}f_{v}\\limsup\\limits_{m \\rightarrow \\infin}p_{n_md-v}\\\\ \\le\u0026\\sum_{v=1,v \\ne s}^{\\infin}f_{v}\\limsup\\limits_{k \\rightarrow \\infin}p_k\\quad\\text{（上极限的定义）}\\\\ =\u0026\\bigg(\\sum_{v=1,v \\ne s}^{\\infin}f_{v}\\bigg)\\limsup\\limits_{k \\rightarrow \\infin}p_k \\end{aligned} \\tag{41} $$ 注意状态 $j$ 是常返的，所以 $\\displaystyle\\sum_{v=1}^{\\infin}f_{v}=1$ ，也就是 $\\displaystyle\\sum_{v=1,v \\ne s}^{\\infin}f_{v}=1-f_s$ 。而将(38)式 代入(41)式后再将(41)式代回(40)式得\n$$ \\lambda\\le f_s\\liminf\\limits_{m \\rightarrow \\infin}p_{n_md-s}+(1-f_s)\\lambda \\tag{42} $$即\n$$ \\liminf\\limits_{m \\rightarrow \\infin}p_{n_md-s}\\ge\\lambda \\tag{43} $$ 由周期的定义和 $f_s\u0026gt;0$ 知 $d$ 必整除 $s$ 。因此 $\\limsup\\limits_{m \\rightarrow \\infin}p_{n_md-s}=\\limsup\\limits_{m \\rightarrow \\infin}p_{n_md}=\\lambda$ 。但是由上下极限的定义可知 $\\limsup\\limits_{m \\rightarrow \\infin}p_{n_md-s}\\ge\\liminf\\limits_{m \\rightarrow \\infin}p_{n_md-s}$ ，即 $\\lambda=\\limsup\\limits_{m \\rightarrow \\infin}p_{n_md-s}\\ge\\liminf\\limits_{m \\rightarrow \\infin}p_{n_md-s}\\ge\\lambda$ 。故由夹挤准则可知 $\\limsup\\limits_{m \\rightarrow \\infin}p_{n_md-s}=\\liminf\\limits_{m \\rightarrow \\infin}p_{n_md-s}=\\lim\\limits_{m \\rightarrow \\infin}p_{n_md-s}=\\lambda$ 。又由(39)式可得：\n$$ \\lambda=\\lim\\limits_{m \\rightarrow \\infin}p_{n_md}=\\lim\\limits_{m \\rightarrow \\infin}p_{n_md-s}=\\lim\\limits_{m \\rightarrow \\infin}p_{n_md-2s}=\\cdots \\tag{44} $$ 任取 $l$ 个正整数 $c_i$ 和满足 $f_{d_i}\u0026gt;0$ 的 $l$ 个正整数 $d_i,i=1,2,\\cdots,l$ 。由(44)式可知有\n$$ \\lim\\limits_{m \\rightarrow \\infin}p_{n_md-c_id_i}=\\lambda \\tag{45} $$ 注意由周期的定义，$d$ 一定可以整除 $d_i$ 。假设 $d_i=k_id$ ， $k_i$ 为正整数，则(45)式又可以写为\n$$ \\lim\\limits_{m \\rightarrow \\infin}p_{(n_m-c_ik_i)d}=\\lambda \\tag{46} $$ 可以定义一个正整数 $n_m^\\prime=n_m-c_ik_i$ 。则(46)式可以写成\n$$ \\lim\\limits_{m \\rightarrow \\infin}p_{n_m^\\prime d}=\\lambda \\tag{47} $$ 我们发现(47)式和(39)式形式完全一样，因此再次重复从(39)式到(44)式的推导又可以得到\n$$ \\lambda=\\lim\\limits_{m \\rightarrow \\infin}p_{n_m^\\prime d}=\\lim\\limits_{m \\rightarrow \\infin}p_{n_m^\\prime d-s^\\prime}=\\lim\\limits_{m \\rightarrow \\infin}p_{n_m^\\prime d-2s^\\prime}=\\cdots \\tag{48} $$ 也就是\n$$ \\lim\\limits_{m \\rightarrow \\infin}p_{n_m^\\prime d-c_{i^\\prime}d_{i^\\prime}}=\\lambda \\tag{49} $$ 因此，不同的 $c_id_i$ 可以叠加而不影响结论。故对 $u=\\displaystyle\\sum_{i=1}^{l}c_id_i$ 也满足\n$$ \\lim\\limits_{m \\rightarrow \\infin}p_{n_md-u}=\\lambda \\tag{50} $$ 由周期 $d$ 的定义知，存在满足 $f_{d_i}\u0026gt;0$ 的 $d_i,i=1,2,\\cdots,l$ 使得 $d_1,d_2,\\cdots,d_l$ 的最大公因子也是 $d$ 。于是，当 $k$ 大于某个正整数 $k_0$ 时，必有正整数 $c_i$ ，使得\n$$ kd=\\sum_{i=1}^{l}c_id_i \\tag{51} $$ 上式的证明可由多元一次不定方程解的存在性的推论得出。\n","date":"2024-09-14T21:05:01+08:00","permalink":"https://www.brasswrench.cn/posts/mathematics/stochastic_processes/markov_process/","title":"随机过程（四）：马尔可夫过程"}]
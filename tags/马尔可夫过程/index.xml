<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>马尔可夫过程 on 黄铜扳手的图书馆</title>
        <link>https://www.brasswrench.com/tags/%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B/</link>
        <description>Recent content in 马尔可夫过程 on 黄铜扳手的图书馆</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>黄铜扳手</copyright>
        <lastBuildDate>Wed, 25 Sep 2024 16:33:55 +0800</lastBuildDate><atom:link href="https://www.brasswrench.com/tags/%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>随机过程（四）：马尔可夫过程</title>
        <link>https://www.brasswrench.com/posts/mathematics/stochastic_processes/markov_process/</link>
        <pubDate>Sat, 14 Sep 2024 21:05:01 +0800</pubDate>
        
        <guid>https://www.brasswrench.com/posts/mathematics/stochastic_processes/markov_process/</guid>
        <description>







&lt;iframe
  class=&#34;netease-cloud-music-frame&#34;
  title=&#34;song&amp;#39;s 1968959950&#34;
  frameborder=&#34;no&#34;
  border=&#34;0&#34;
  marginwidth=&#34;0&#34;
  marginheight=&#34;0&#34;
  width=&#34;100%&#34;
  height=&#34;86&#34;
  loading=&#34;lazy&#34;
  src=&#34;https://music.163.com/outchain/player?type=2&amp;amp;id=1968959950&amp;amp;auto=0&amp;amp;height=66&#34;&gt;
&lt;/iframe&gt;

&lt;h1 id=&#34;马尔可夫过程&#34;&gt;马尔可夫过程
&lt;/h1&gt;&lt;h2 id=&#34;引言&#34;&gt;引言
&lt;/h2&gt;&lt;p&gt;  有一类随机过程，它具备所谓的“无后效性”(马尔可夫性)，即，要确定过程将来的状态，知道它此刻的情况就足够了，并不需要对它以往的情况的认识，这类过程称为马尔可夫过程。本文将介绍马尔可夫过程中最简单的两种类型：离散时间马尔可夫链（简称马氏链）及连续时间的马尔可夫链。&lt;/p&gt;
&lt;h2 id=&#34;基本概念&#34;&gt;基本概念
&lt;/h2&gt;&lt;h3 id=&#34;马尔可夫链的定义&#34;&gt;马尔可夫链的定义
&lt;/h3&gt;&lt;h4 id=&#34;马尔可夫链&#34;&gt;马尔可夫链
&lt;/h4&gt;&lt;p&gt;  &lt;strong&gt;定义1&lt;/strong&gt;：给定随机过程 $\{X_n,n=0,1,2,\cdots\}$ ，若它只取有限或可列个值 $E_0,E_1,E_2,\cdots$（我们以 $\{0,1,2,\cdots\}$ 来标记 $E_0,E_1,E_2$ 并称他们是过程的状态， $\{0,1,2\cdots\}$ 或者其子集记为 $S$ ，称为过程的&lt;strong&gt;状态空间&lt;/strong&gt;）。若对 $\{X_n,n=0,1,2,\cdots\}$ （一般就认为它的状态是非负整数）和任意的 $\;n\ge0\;$ 及状态 $i,j,i_0,i_1\cdots,i_{n-1}$ ，有&lt;/p&gt;
$$
\begin{aligned}
&amp;P\{X_{n+1}=j\;|\;X_0=i_0,X_1=i_1,X_2=i_2,\cdots,X_{n-1}=i_{n-1},X_n=i\}\\[5pt]
=&amp;P\{X_{n+1}=j\;|\;X_n=i\}
\end{aligned}
\tag{1}
$$&lt;p&gt;  则称随机过程 $\{X_n,n=0,1,2,\cdots\}$ 为&lt;strong&gt;马尔可夫链&lt;/strong&gt;。&lt;/p&gt;
&lt;h4 id=&#34;马尔可夫性&#34;&gt;马尔可夫性
&lt;/h4&gt;&lt;p&gt;  &lt;a class=&#34;link&#34; href=&#34;#%e9%a9%ac%e5%b0%94%e5%8f%af%e5%a4%ab%e9%93%be&#34; &gt;式1&lt;/a&gt;刻画了马尔可夫链的特性，故称为&lt;strong&gt;马尔可夫性&lt;/strong&gt;。&lt;/p&gt;
&lt;h3 id=&#34;转移概率&#34;&gt;转移概率
&lt;/h3&gt;&lt;h4 id=&#34;转移概率-1&#34;&gt;转移概率
&lt;/h4&gt;&lt;p&gt;  &lt;strong&gt;定义2&lt;/strong&gt;：称&lt;a class=&#34;link&#34; href=&#34;#%e9%a9%ac%e5%b0%94%e5%8f%af%e5%a4%ab%e9%93%be&#34; &gt;式1&lt;/a&gt;中的条件概率 $P\{X_{n+1}=j\;|\;X_n=i\}$ 为马尔可夫链 $\{X_n,n=0,1,2,\cdots\}$ 的&lt;strong&gt;一步转移概率&lt;/strong&gt;，简称&lt;strong&gt;转移概率&lt;/strong&gt;。&lt;br&gt;
  一般情况下，转移概率与状态$i,j$和时刻$n$有关。&lt;/p&gt;
&lt;h4 id=&#34;时齐马尔可夫链&#34;&gt;时齐马尔可夫链
&lt;/h4&gt;&lt;p&gt;  &lt;strong&gt;定义3&lt;/strong&gt;：当马尔可夫链的转移概率只与状态 $i,j$ 有关，而与 $n$ 无关时，称马尔可夫链为&lt;strong&gt;时齐&lt;/strong&gt;的，并记 $p_{ij}=P\{X_{n+1}=j\;|\;X_n=i\}(n \ge 0)$ ；否则，就称之为&lt;strong&gt;非时齐&lt;/strong&gt;的。&lt;br&gt;
  本文只讨论时齐马尔可夫链并将其简称为马尔可夫链。&lt;/p&gt;
&lt;h4 id=&#34;有限链和无限链&#34;&gt;有限链和无限链
&lt;/h4&gt;&lt;p&gt;  当马尔可夫链的状态为有限时，成为&lt;strong&gt;有限链&lt;/strong&gt;，否则成为&lt;strong&gt;无限链&lt;/strong&gt;。但无论状态有限还是无限，我们都可以将 $p_{ij}(i,j\in S)$ 排成一个矩阵的形式，令&lt;/p&gt;
$$
\mathbf{P}=(p_{ij})=
\begin{pmatrix}
p_{00} &amp; p_{01} &amp; p_{02} &amp; p_{03} &amp; \cdots \\
p_{10} &amp; p_{11} &amp; p_{12} &amp; p_{13} &amp; \cdots \\
p_{20} &amp; p_{21} &amp; p_{22} &amp; p_{23} &amp; \cdots \\
p_{30} &amp; p_{31} &amp; p_{32} &amp; p_{33} &amp; \cdots \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots \\
\end{pmatrix}
\tag{2}
$$&lt;p&gt;  则称 $\mathbf{P}$ 为&lt;strong&gt;转移概率矩阵&lt;/strong&gt;，一般称为&lt;strong&gt;转移矩阵&lt;/strong&gt;。容易看出 $p_{ij}(i,j\in S)$ 有性质&lt;/p&gt;
$$
\begin{aligned}
&amp;(1)\; p_{ij} \ge 0, \;i,j\in S \\[5pt]
&amp;(2)\; \sum_{j \in S}{p_{ij}} = 1, \forall i \in S
\end{aligned}
\tag{3}
$$&lt;h3 id=&#34;n步转移概率与c-k方程&#34;&gt;n步转移概率与C-K方程
&lt;/h3&gt;&lt;h4 id=&#34;n步转移概率&#34;&gt;n步转移概率
&lt;/h4&gt;&lt;p&gt;  &lt;strong&gt;定义4&lt;/strong&gt;：称条件概率&lt;/p&gt;
$$
p_{ij}^{(n)}=P\{X_{m+n}=j\;|\;X_m=i\}\quad i,j\in S,m \ge 0, n \ge 1
\tag{4}
$$&lt;p&gt;为马尔可夫链的&lt;strong&gt;n步转移概率&lt;/strong&gt;，相应地称 $\mathbf{P}^{(n)}=(p_{ij}^{(n)})$ 为&lt;strong&gt;n步转移矩阵&lt;/strong&gt;。&lt;br&gt;
  当 $n=1$ 时， $p_{ij}^{(1)}=p_{ij}$ ， $\mathbf{P}^{(1)}=\mathbf{P}$ 。此外规定&lt;/p&gt;
$$
p_{ij}^{(0)}=
\begin{cases}
0, \quad i \ne j\\[5pt]
1, \quad i=j
\end{cases}
\tag{5}
$$&lt;p&gt;  显然，n步转移概率 $p_{ij}^{(n)}$ 指的就是系统从状态 $i$ 经过 $n$ 步后转移到了 $j$ 的概率，它对中间的 $n-1$ 步转移经过的状态无要求。下面的定理给出了 $p_{ij}^{(n)}$ 和 $p_{ij}$ 的关系。&lt;/p&gt;
&lt;h4 id=&#34;c-k方程&#34;&gt;C-K方程
&lt;/h4&gt;&lt;p&gt;  &lt;strong&gt;定理1（Chapman-Kolmogorov方程，简称C-K方程）&lt;/strong&gt;：对一切 $n,m \ge 0$ ， $i,j \in S$ 有&lt;/p&gt;
&lt;p&gt;  ①&lt;/p&gt;
$$
p_{ij}^{(m+n)}=\sum_{k \in S}{p_{ik}^{(m)}}p_{kj}^{(n)}
\tag{6}
$$&lt;p&gt;  ②
&lt;/p&gt;
$$
\mathbf{P}^{(n)}=\mathbf{P} \cdot \mathbf{P}^{(n-1)} = \mathbf{P} \cdot \mathbf{P} \cdot \mathbf{P}^{(n-2)} = \cdots = \mathbf{P}^n
\tag{7}
$$&lt;p&gt;  &lt;strong&gt;证明（定理1）&lt;/strong&gt;：由&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“概率论”还未上线~&#39;)&#34;&gt;全概率公式&lt;/a&gt;可得&lt;/p&gt;
$$
\begin{aligned}
p_{ij}^{(m+n)}&amp;=P\{X_{m+n}=j\;|\;X_0=i\}\\[5pt]
&amp;=\frac{P\{X_{m+n}=j,X_0=i\}}{P\{X_0=i\}}\\[10pt]
&amp;=\sum_{k \in S}{\frac{P\{X_{m+n}=j,X_m=k,X_0=i\}}{P\{X_0=i\}}}\text{（全概率公式）}\\
&amp;=\sum_{k \in S}{\frac{P\{X_{m+n}=j,X_m=k,X_0=i\}}{P\{X_m=k,X_0=i\}}\frac{P\{X_m=k,X_0=i\}}{P\{X_0=i\}}}\\
&amp;=\sum_{k \in S}{P\{X_{m+n}=j\;|\;X_m=k,X_0=i\}}P\{X_m=k\;|\;X_0=i\}\\
&amp;=\sum_{k \in S}{p_{kj}^{(n)}p_{ik}^{(m)}}\\
&amp;=\sum_{k \in S}{p_{ik}^{(m)}p_{kj}^{(n)}}
\end{aligned}
\tag{8}
$$&lt;p&gt;  由矩阵乘法易得②是①的矩阵形式。&lt;/p&gt;
&lt;h2 id=&#34;状态的分类及性质&#34;&gt;状态的分类及性质
&lt;/h2&gt;&lt;h3 id=&#34;可达互通类可约&#34;&gt;可达、互通、类、可约
&lt;/h3&gt;&lt;p&gt;  &lt;strong&gt;定义5&lt;/strong&gt;：称状态 $i$ &lt;strong&gt;可达&lt;/strong&gt;状态 $j(i,j \in S)$，若存在 $n \ge 0$ 使得 $p_{ij}^{(n)} \ge 0$ ，记为 $i \rightarrow j$ 。若同时有状态 $j \rightarrow i$ ，则称 $i$ 与 $j$ &lt;strong&gt;互通&lt;/strong&gt;，记为 $i \leftrightarrow j$ 。&lt;/p&gt;
&lt;p&gt;  &lt;strong&gt;定理2&lt;/strong&gt;：互通是一种等价关系，即满足：&lt;br&gt;
  ①自反性： $i \leftrightarrow i$ ；&lt;br&gt;
  ②对称性： $i \leftrightarrow j$ ，则 $j \leftrightarrow i$ ；&lt;br&gt;
  ③传递性： $i \leftrightarrow j$ , $j \leftrightarrow k$ ，则 $i \leftrightarrow k$ 。&lt;/p&gt;
&lt;p&gt;  &lt;strong&gt;证明（定理2）&lt;/strong&gt;：从互通的定义可知①②是显然的，只证③。由互通定义可知，需证 $i \rightarrow k$ 且 $k \rightarrow i$ 。首先，由 $i \rightarrow j$ ， $j \rightarrow k$ 可知存在 $m$ ， $n$ 使得 $p_{ij}^{(m)}&amp;gt;0$ ， $p_{jk}^{(n)}&amp;gt;0$ 。再由&lt;a class=&#34;link&#34; href=&#34;#c-k%e6%96%b9%e7%a8%8b&#34; &gt;C-K方程&lt;/a&gt;和&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“概率论”还未上线~&#39;)&#34;&gt;概率的非负性&lt;/a&gt;可知 $p_{ik}^{(m+n)}=\displaystyle\sum_{l \in S}{p_{il}^{(m)}p_{lk}^{(n)}}\ge {p_{ij}^{(m)}p_{jk}^{(n)}}&amp;gt;0$ ，故 $i \rightarrow k$ 。反过来同样有 $k \rightarrow i$ ，即证 $i \leftrightarrow k$ 。&lt;/p&gt;
&lt;p&gt;  我们把任何两个相通状态归为一个&lt;strong&gt;类&lt;/strong&gt;，由上述定理可知，同在一类的状态应该都是互通的，并且任何一个状态不能同时属于两个不同的类。&lt;/p&gt;
&lt;p&gt;  &lt;strong&gt;定义6&lt;/strong&gt;：若马尔可夫链只存在一个类，就称它是&lt;strong&gt;不可约的&lt;/strong&gt;。否则称为&lt;strong&gt;可约的&lt;/strong&gt;。&lt;/p&gt;
&lt;h3 id=&#34;周期&#34;&gt;周期
&lt;/h3&gt;&lt;p&gt;  &lt;strong&gt;定义7&lt;/strong&gt;：若集合 $\{n|n \ge 1,p_{ii}^{(n)} \ge 0\}$ 非空，则称它的最大公约数 $d=d(i)$ 为状态 $i$ 的&lt;strong&gt;周期&lt;/strong&gt;。若 $d \ge 1$ ，则称 $i$ 是&lt;strong&gt;周期的&lt;/strong&gt;；若 $d=1$ ，则称 $i$ 是&lt;strong&gt;非周期的&lt;/strong&gt;。并特别规定上述集合为空集时，称 $i$ 的周期为&lt;strong&gt;无穷大&lt;/strong&gt;。 。&lt;/p&gt;
&lt;p&gt;&lt;span id=&#34;定理3&#34;&gt;&lt;/span&gt;
  &lt;strong&gt;定理3&lt;/strong&gt;：若状态 $i,j$ 同属一类，则 $d(i)=d(j)$ 。&lt;/p&gt;
&lt;p&gt;  &lt;strong&gt;证明（定理3）&lt;/strong&gt;：由&lt;a class=&#34;link&#34; href=&#34;#%e5%8f%af%e8%be%be%e4%ba%92%e9%80%9a%e7%b1%bb%e5%8f%af%e7%ba%a6&#34; &gt;类&lt;/a&gt;的定义可知 $i \leftrightarrow j$ ，即存在 $m,n$ 使$p_{ij}^{(m)}&amp;gt;0,p_{ji}^{(n)}&amp;gt;0$。则由&lt;a class=&#34;link&#34; href=&#34;#c-k%e6%96%b9%e7%a8%8b&#34; &gt;C-K方程&lt;/a&gt;和&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“概率论”还未上线~&#39;)&#34;&gt;概率的非负性&lt;/a&gt;知 $p_{ii}^{(m+n)}=\displaystyle\sum_{k \in S}{p_{ik}^{(m)}p_{ki}^{(n)}} \ge p_{ij}^{(m)}p_{ji}^{(n)}&amp;gt;0$ 。同时对所有使得 $p_{jj}^{(s)} &amp;gt; 0$ 的 $s$ ，有&lt;/p&gt;
$$
p_{ii}^{(m+s+n)}=\sum_{k \in S}{p_{ik}^{(m)}p_{ki}^{(s+n)}}=\sum_{k \in S,\thinspace l \in S}{p_{ik}^{(m)}p_{kl}^{(s)}p_{li}^{(n)}} \ge p_{ij}^{(m)}p_{jj}^{(s)}p_{ji}^{(n)}&gt;0
\tag{9}
$$&lt;p&gt;  由&lt;a class=&#34;link&#34; href=&#34;#%e5%91%a8%e6%9c%9f&#34; &gt;周期&lt;/a&gt;的定义可知，由于 $p_{ii}^{(m+n)}&amp;gt;0$ 且 $p_{ii}^{(m+s+n)}&amp;gt;0$ ， $d(i)$ 必然同时整除 $n+m$ 和 $n+m+s$ ，因此，它也必然整除 $s$ （见&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“初等数论”还未上线~&#39;)&#34;&gt;整除的基本性质&lt;/a&gt;）。同时我们还需注意我们已经假设了 $p_{jj}^{(s)} &amp;gt; 0$ ，因此 $d(j)$ 必定也整除 $s$ 。注意 $s$ 的任意性，不妨直接令 $s=d(j)$ ，由此可得 $d(i)$ 整除 $d(j)$ 。我们把上述证明的 $i$ 和 $j$ 交换一下，就也能得到 $d(j)$ 整除 $d(i)$ ，于是 $d(i)=d(j)$ （见&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“初等数论”还未上线~&#39;)&#34;&gt;整除的基本性质&lt;/a&gt;）。&lt;/p&gt;
&lt;h3 id=&#34;常返&#34;&gt;常返
&lt;/h3&gt;&lt;h4 id=&#34;常返与非常返瞬过&#34;&gt;常返与非常返（瞬过）
&lt;/h4&gt;&lt;p&gt;  &lt;strong&gt;定义8&lt;/strong&gt;：对于任何状态 $i,j$ ，以 $f_{ij}^{(n)}$ 记从i出发经n步后首次到达 $j$ 的概率，则有&lt;/p&gt;
$$
f_{ij}^{(n)}=
\begin{cases}
0 \quad n=0 \\[5pt]
P\{X_n=j,X_k \ne j(k=1,2,\cdots ,n-1)\;|\; X_0=i\} \quad n \ge 1
\end{cases}
\tag{10}
$$&lt;p&gt;  令 $f_{ij}=\displaystyle\sum_{n=1}^{\infin}{f_{ij}^{(n)}}$ ，若 $f_{jj}=1$ ，则称状态 $j$ 为&lt;strong&gt;常返状态&lt;/strong&gt;，若 $f_{jj}&amp;lt;1$ ，称 $j$ 为&lt;strong&gt;非常返状态&lt;/strong&gt;或&lt;strong&gt;瞬过状态&lt;/strong&gt;。&lt;br&gt;
   $f_{ij}$ 的含义可由如下得出：由集合 $A_n$ 的定义 $A_n=\{X_n=j,X_k \ne j, k=1,2,\cdots n-1 \;|\; X_0=i\}$ 可知 $n$ 不同的时候 $A_n$ 不相交。而 $\displaystyle\bigcup_{n=1}^{\infin}{A_n}$表示的事件正是总有一个 $n$ 使得过程经 $n$ 步后可从 $i$ 到达 $j$ ,那么由不相交事件概率的可加性可得：&lt;/p&gt;
$$
P(\bigcup_{n=1}^{\infin}{A_n})=\sum_{n=1}^{\infin}{P(A_n)}=\sum_{n=1}^{\infin}f_{ij}^{(n)}=f_{ij}
\tag{11}
$$&lt;p&gt;  因此 $f_{ij}$ 表示从 $i$ 出发，有限步内可以到达 $j$ 的概率。当 $i$ 为常返状态时，以概率 $1$ 从 $i$ 出发，在有限步过程将重新返回 $i$ ，而当 $i$ 为非常返状态时，若也以概率 $1$ 从 $i$ 出发，则以概率 $1-f_{ii}$ 不再回到 $i$ （即从 $i$ 滑过）。&lt;br&gt;
  对于常返态 $i$ ，定义&lt;/p&gt;
$$
\mu_i=\sum_{n=1}^{\infin}{nf_{ii}^{(n)}}
\tag{12}
$$&lt;p&gt;  表示由 $i$ 出发再返回到 $i$ 所需的平均步数（时间）。&lt;/p&gt;
&lt;h4 id=&#34;正常返零常返遍历吸收&#34;&gt;正常返、零常返、遍历、吸收
&lt;/h4&gt;&lt;p&gt;  &lt;strong&gt;定义9&lt;/strong&gt;：对于常返态 $i$ ，若 $\mu_i&amp;lt;+\infin$，则称 $i$ 为&lt;strong&gt;正常返态&lt;/strong&gt;；若 $\mu_i=+\infin$ ，则称 $i$ 为&lt;strong&gt;零常返态&lt;/strong&gt;。特别地，若 $i$ 正常返且是&lt;a class=&#34;link&#34; href=&#34;#%e5%91%a8%e6%9c%9f&#34; &gt;非周期的&lt;/a&gt;，则称之为&lt;strong&gt;遍历状态&lt;/strong&gt;。若 $i$ 是遍历状态，且 $f_{ii}^{(1)}=1$，则称 $i$ 为&lt;strong&gt;吸收状态&lt;/strong&gt;。此时显然 $\mu_i=1$ 。&lt;/p&gt;
&lt;h3 id=&#34;若干性质证明&#34;&gt;若干性质证明
&lt;/h3&gt;&lt;h4 id=&#34;常返的极限判定&#34;&gt;常返的极限判定
&lt;/h4&gt;&lt;p&gt;&lt;span id=&#34;定理4&#34;&gt;&lt;/span&gt;
  &lt;strong&gt;定理4&lt;/strong&gt;：状态 $i$ 为常返状态当且仅当 $\displaystyle\sum_{n=0}^{\infin}{p_{ii}^{(n)}}=+\infin$ 。状态 $i$ 为非常返状态时&lt;/p&gt;
$$
\sum_{n=0}^{(\infin)}{p_{ii}^{(n)}}=\frac{1}{1-f_{ii}}
\tag{13}
$$&lt;p&gt;  因而此时有 $\lim\limits_{n \rightarrow \infin}p_{ii}^{(n)}=0$ 。&lt;/p&gt;
&lt;p&gt;  为了证明&lt;a class=&#34;link&#34; href=&#34;#%e5%ae%9a%e7%90%864&#34; &gt;&lt;strong&gt;定理4&lt;/strong&gt;&lt;/a&gt;，我们需要先证明&lt;a class=&#34;link&#34; href=&#34;#%e7%bb%93%e8%ae%ba1&#34; &gt;结论1&lt;/a&gt;和&lt;a class=&#34;link&#34; href=&#34;#%e5%bc%95%e7%90%861&#34; &gt;引理1&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;&lt;span id=&#34;结论1&#34;&gt;&lt;/span&gt;
  &lt;strong&gt;结论1&lt;/strong&gt;：对任意状态 $i,j$ ，有&lt;/p&gt;
$$
f_{ij}^{(l+1)}=\sum_{k \ne j,\thinspace k \in S}{f_{ik}^{(1)}f_{kj}^{(l)}}
\tag{14}
$$&lt;p&gt;  &lt;strong&gt;证明（结论1）&lt;/strong&gt;：由&lt;a class=&#34;link&#34; href=&#34;#%e5%b8%b8%e8%bf%94&#34; &gt; $f_{ij}^{(n)}$ 的定义&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;#%e9%a9%ac%e5%b0%94%e5%8f%af%e5%a4%ab%e6%80%a7&#34; &gt;马尔可夫性&lt;/a&gt;、&lt;a class=&#34;link&#34; href=&#34;#%e6%97%b6%e9%bd%90%e9%a9%ac%e5%b0%94%e5%8f%af%e5%a4%ab%e9%93%be&#34; &gt;时齐性&lt;/a&gt;和&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“概率论”还未上线~&#39;)&#34;&gt;全概率公式&lt;/a&gt;可得&lt;/p&gt;
$$
\begin{aligned}
f_{ij}^{(l+1)}=&amp;P\{X_{l+1}=j,X_m \ne j(m=1,2,\cdots ,l) \;|\; X_0=i\}\quad \text{（}f_{ij}^{(n)}\text{的定义）}\\[5pt]
=&amp;\sum_{k \ne j,\thinspace k \in S}{P\{X_{l+1}=j,X_m \ne j(m=2,\cdots ,l),X_1=k \;|\; X_0=i\}}\text{（全概率公式）}\\
=&amp;\sum_{k \ne j,\thinspace k \in S}{\frac{P\{X_{l+1}=j,X_m \ne j(m=2,\cdots ,l),X_1=k,X_0=i\}}{P\{X_0=i\}}}\\
=&amp;\sum_{k \ne j,\thinspace k \in S}{\frac{P\{X_1=k,X_0=i\}}{P\{X_0=i\}}\frac{P\{X_{l+1}=j,X_m \ne j(m=2,\cdots ,l),X_1=k,X_0=i\}}{P\{X_1=k,X_0=i\}}}\\
=&amp;\sum_{k \ne j,\thinspace k \in S}{P\{X_1=k\;|\;X_0=i\}P\{X_{l+1}=j,X_m \ne j(m=2,\cdots ,l)\;|\;X_1=k,X_0=i\}}\\
=&amp;\sum_{k \ne j,\thinspace k \in S}{P\{X_1=k\;|\;X_0=i\}P\{X_{l+1}=j,X_m \ne j(m=2,\cdots ,l)\;|\;X_1=k\}}\text{（马尔可夫性）}\\
=&amp;\sum_{k \ne j,\thinspace k \in S}{P\{X_1=k\;|\;X_0=i\}P\{X_l=j,X_m \ne j(m=1,\cdots ,l-1)\;|\;X_0=k\}}\text{（时齐性）}\\
=&amp;\sum_{k \ne j,\thinspace k \in S}{f_{ik}^{(1)}f_{kj}^{(l)}}
\end{aligned}
\tag{15}
$$&lt;p&gt;&lt;span id=&#34;引理1&#34;&gt;&lt;/span&gt;
  &lt;strong&gt;引理1&lt;/strong&gt;：对任意状态 $i,j$ 及 $1 \le n &amp;lt; \infin$ ，有&lt;/p&gt;
$$
p_{ij}^{(n)}=\sum_{l=1}^{n}{f_{ij}^{(l)}p_{jj}^{(n-l)}}
\tag{16}
$$&lt;p&gt;  &lt;strong&gt;证明（引理1）&lt;/strong&gt;：用归纳法。对 $n=1$，由 $p_{ij}^{(1)}=f_{ij}^{(1)}$，易证&lt;a class=&#34;link&#34; href=&#34;#%e5%ae%9a%e7%90%864&#34; &gt;式(16)&lt;/a&gt;成立。&lt;br&gt;
  假设对 $n-1$ ，已有 $p_{ij}^{(n-1)}=\displaystyle\sum_{l=1}^{n-1}{f_{ij}^{(l)}p_{jj}^{(n-1-l)}}$ 成立。&lt;br&gt;
  当取 $n$ 时，利用&lt;a class=&#34;link&#34; href=&#34;#c-k%e6%96%b9%e7%a8%8b&#34; &gt;C-K方程&lt;/a&gt;、归纳假设和&lt;a class=&#34;link&#34; href=&#34;#%e7%bb%93%e8%ae%ba1&#34; &gt;结论1&lt;/a&gt;，可以推导出&lt;/p&gt;
$$
\begin{aligned}
p_{ij}^{(n)}&amp;=\sum_{k \in S}{p_{ik}^{(1)}p_{kj}^{(n-1)}} \qquad \text{（C-K方程）}\\
&amp;=p_{ij}^{(1)}p_{jj}^{(n-1)}+\sum_{k \ne j,\thinspace k \in S}{p_{ik}^{(1)}p_{kj}^{(n-1)}}\\
&amp;=f_{ij}^{(1)}p_{jj}^{(n-1)}+\sum_{k \ne j,\thinspace k \in S}{f_{ik}^{(1)}p_{kj}^{(n-1)}} \text{（归纳法n=1时的情况）}\\
&amp;=f_{ij}^{(1)}p_{jj}^{(n-1)}+\sum_{k \ne j,\thinspace k \in S}{f_{ik}^{(1)}\bigg(\sum_{l=1}^{n-1}{f_{kj}^{(l)}p_{jj}^{(n-1-l)}}}\bigg) \text{（归纳假设n-1时的情况）}\\
&amp;=f_{ij}^{(1)}p_{jj}^{(n-1)}+\sum_{l=1}^{n-1}{\bigg(\sum_{k \ne j,\thinspace k \in S}{f_{ik}^{(1)}f_{kj}^{(l)}}\bigg)p_{jj}^{(n-1-l)}}\\
&amp;=f_{ij}^{(1)}p_{jj}^{(n-1)}+\sum_{l=1}^{n-1}{f_{ij}^{(l+1)}p_{jj}^{(n-1-l)}} \quad \text{(引理1)}\\
&amp;=f_{ij}^{(1)}p_{jj}^{(n-1)}+\sum_{l=2}^{n}{f_{ij}^{(l)}p_{jj}^{(n-l)}}\\
&amp;=\sum_{l=1}^{n}{f_{ij}^{(l)}p_{jj}^{(n-l)}}\\
\end{aligned}
\tag{17}
$$&lt;p&gt;  现在，我们可以用&lt;a class=&#34;link&#34; href=&#34;#%e5%bc%95%e7%90%861&#34; &gt;引理1&lt;/a&gt;证明&lt;a class=&#34;link&#34; href=&#34;#%e5%ae%9a%e7%90%864&#34; &gt;&lt;strong&gt;定理4&lt;/strong&gt;&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;  &lt;strong&gt;证明（定理4）&lt;/strong&gt;：&lt;/p&gt;
$$
\begin{aligned}
\sum_{n=0}^{\infin}{p_{ii}^{(n)}}=&amp;\:p_{ii}^{(0)}+\sum_{n=1}^{\infin}{p_{ii}^{(n)}}\\
=&amp;\:1+\sum_{n=1}^{\infin}\bigg(\sum_{l=1}^{n}{f_{ii}^{(l)}p_{ii}^{(n-l)}}\bigg) \quad \text{（引理1）}\\
=&amp;\:1+\sum_{l=1}^{\infin}\sum_{n=l}^{\infin}{f_{ii}^{(l)}p_{ii}^{(n-l)}}\\
=&amp;\:1+\sum_{l=1}^{\infin}\sum_{m=0}^{\infin}{f_{ii}^{(l)}p_{ii}^{(m)}}\\
=&amp;\:1+\bigg(\sum_{l=1}^{\infin}{f_{ii}^{(l)}}\bigg)\bigg(\sum_{n=0}^{\infin}{p_{ii}^{(n)}}\bigg)\\
=&amp;\:1+f_{ii}\bigg(\sum_{n=0}^{\infin}{p_{ii}^{(n)}}\bigg)
\end{aligned}
\tag{18}
$$&lt;p&gt;  左右有相同项 $\displaystyle\sum_{n=0}^{\infin}{p_{ii}^{(n)}}$，则解该等式得&lt;/p&gt;
$$
\sum_{n=0}^{\infin}{p_{ii}^{(n)}}=\frac{1}{1-f_{ii}}
\tag{19}
$$&lt;p&gt;  因此&lt;/p&gt;
$$
\sum_{n=0}^{\infin}{p_{ii}^{(n)}}\text{收敛}\iff f_{ii}&lt;1\text{；}
\sum_{n=0}^{\infin}{p_{ii}^{(n)}}=\infin \iff f_{ii}=1
\tag{20}
$$&lt;h4 id=&#34;常返互通则必达&#34;&gt;常返互通则必达
&lt;/h4&gt;&lt;p&gt;&lt;span id=&#34;引理2&#34;&gt;&lt;/span&gt;
  &lt;strong&gt;引理2&lt;/strong&gt;：若 $i \leftrightarrow j$ 且 $i$ 为常返态，则 $f_{ji}=1$。&lt;/p&gt;
&lt;p&gt;  &lt;strong&gt;证明（引理2）&lt;/strong&gt;：用反证法。假设 $f_{ji}&amp;lt;1$ ，则从 $j$ 出发不一定能在有限步内到达 $i$ ，但是由于 $i \rightarrow j$ ，则从 $i$ 出发一定能在有限步到达 $j$ 。这意味着从 $i$ 出发如果经过 $j$ ，将不一定能在有限步之内再回到 $i$ ，这与 $i$ 的常返性相矛盾，假设不成立。因此 $f_{ij}=1$ 。&lt;/p&gt;
&lt;h4 id=&#34;常返是一个类性质&#34;&gt;常返是一个类性质
&lt;/h4&gt;&lt;p&gt;&lt;span id=&#34;定理5&#34;&gt;&lt;/span&gt;
  &lt;strong&gt;定理5&lt;/strong&gt;：常返性是一个类性质。&lt;br&gt;
  &lt;strong&gt;证明（定理5）&lt;/strong&gt;：先证明若 $i \leftrightarrow j$ 则 $i,j$ 同为常返状态或非常返状态。&lt;br&gt;
  由 $i \leftrightarrow j$ 知。存在 $n, m$ 使得 $p_{ij}^{(n)}&amp;gt;0,p_{ji}^{(m)}&amp;gt;0$ ，由&lt;a class=&#34;link&#34; href=&#34;#c-k%e6%96%b9%e7%a8%8b&#34; &gt;C-K方程&lt;/a&gt;和&lt;a class=&#34;link&#34; href=&#34;#%e5%ae%9a%e7%90%863&#34; &gt;(9)式的展开技巧&lt;/a&gt;易得&lt;/p&gt;
$$
p_{ii}^{(n+m+l)} \ge p_{ij}^{(n)}p_{jj}^{(l)}p_{ji}^{(m)}\\[5pt]
p_{jj}^{(n+m+l)} \ge p_{ji}^{(n)}p_{ii}^{(l)}p_{ij}^{(m)}
\tag{21}
$$&lt;p&gt;  两边求和得到&lt;/p&gt;
$$
\sum_{l=0}^{\infin}{p_{ii}^{(n+m+l)}} \ge \sum_{l=0}^{\infin}{p_{ij}^{(n)}p_{jj}^{(l)}p_{ji}^{(m)}}\\[5pt]
\sum_{l=0}^{\infin}{p_{jj}^{(n+m+l)}} \ge \sum_{l=0}^{\infin}{p_{ji}^{(n)}p_{ii}^{(l)}p_{ij}^{(m)}}
\tag{22}
$$&lt;p&gt;  考虑到 $\displaystyle\sum_{l=0}^{n+m-1}{p_{ii}^{(l)}}$ 和 $\displaystyle\sum_{l=0}^{n+m-1}{p_{jj}^{(l)}}$ 都是有限的，那么可以把上式写成这样：&lt;/p&gt;
$$
\sum_{l=0}^{\infin}{p_{ii}^{(l)}} - \sum_{l=0}^{n+m-1}{p_{ii}^{(l)}} \ge p_{ij}^{(n)}p_{ji}^{(m)}\sum_{l=0}^{\infin}{p_{jj}^{(l)}}\\[5pt]
\sum_{l=0}^{\infin}{p_{jj}^{(l)}} - \sum_{l=0}^{n+m-1}{p_{jj}^{(l)}} \ge p_{ji}^{(n)}p_{ij}^{(m)}\sum_{l=0}^{\infin}{p_{ii}^{(l)}}
\tag{23}
$$&lt;p&gt;  因此我们可以直观的看出 $\displaystyle\sum_{l=0}^{n+m-1}{p_{ii}^{(l)}}$ 和 $\displaystyle\sum_{l=0}^{n+m-1}{p_{jj}^{(l)}}$ 当中任意一个为无穷时，另一个必然也为无穷；任意一个为有限时，另一个必然也为有限。因此 $i,j$ 同为常返状态或非常返状态。故常返性是一个类性质，类中任意成员满足，则其他成员也必定满足；反之若类中任一成员不满足，则其他成员也不满足。&lt;br&gt;
  其次还能证明当 $i,j$ 同为常返状态时，它们同为正常返态或零常返态。该证明见下文&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，还没写完~&#39;)&#34;&gt;证明&lt;/a&gt;处。&lt;/p&gt;
&lt;h4 id=&#34;状态空间分解定理&#34;&gt;状态空间分解定理
&lt;/h4&gt;&lt;p&gt;  &lt;strong&gt;定理6（状态空间分解定理）&lt;/strong&gt;：任意马尔可夫链的状态空间 $S$ ，可唯一分解为有限个或可列个互不相交的子集 $D,C_1,C_2,\cdots$ 之和，使得&lt;br&gt;
  ①每一个 $C_n$ 是常返状态组成的不可约闭集，$D$ 由全体非常返状态组成。。&lt;br&gt;
  ② $C_n$ 中的状态同类，或者全是正常返态，或者全是零常返态。它们有相同的周期且 $f_{ij}=1(i,j \in C_n)$ 。&lt;br&gt;
  ③ 自 $C_n$ 中的状态出发不能到达 $D$ 中状态。&lt;/p&gt;
&lt;p&gt;  &lt;strong&gt;证明（定理6）&lt;/strong&gt;：设 $C$ 为全体常返状态组成的集合，则 $D=S-C$ 为非常返状态的全体组成的集合。注意到定义在 $C$ 上的互通是一种等价关系，由&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“离散数学”还未上线~&#39;)&#34;&gt;等价关系与集合的划分&lt;/a&gt;可知， $C$ 可以按互通关系划分为 $C_1 \bigcup C_2 \bigcup \dots$ ，其中每一个 $C_n$ 是由同一类常返状态组成的不可约的闭集。因此 $S=D \bigcup C_1 \bigcup C_2 \bigcup \dots$ 。定理假设和①证毕。由&lt;a class=&#34;link&#34; href=&#34;#%e5%ae%9a%e7%90%865&#34; &gt;定理5&lt;/a&gt;可知 $C_n$ 中的状态都是同类型的（正常返或零常返），由&lt;a class=&#34;link&#34; href=&#34;#%e5%ae%9a%e7%90%863&#34; &gt;定理3&lt;/a&gt;可知 $C_n$ 中的状态都有相同的周期，由&lt;a class=&#34;link&#34; href=&#34;#%e5%bc%95%e7%90%862&#34; &gt;引理2&lt;/a&gt;可知 $C_n$ 中的状态都满足 $f_{ij}=1(i,j \in C_n)$ 。②证毕。对于③，可用反证法证明。假设 $C_n$ 中的状态 $i$ 可以到达 $D$ 中的状态 $j$ ，由于 $i$ 是&lt;a class=&#34;link&#34; href=&#34;#%e5%b8%b8%e8%bf%94%e4%b8%8e%e9%9d%9e%e5%b8%b8%e8%bf%94%e7%9e%ac%e8%bf%87&#34; &gt;常返&lt;/a&gt;的，状态在到达 $j$ 后必定还会再返回 $i$ ，而后再由假设，状态还可能继续回到 $j$ 。因此，状态从 $j$ 出发后再次返回 $j$ 的情况是可能出现的，这与 $j$ 是&lt;a class=&#34;link&#34; href=&#34;#%e5%b8%b8%e8%bf%94%e4%b8%8e%e9%9d%9e%e5%b8%b8%e8%bf%94%e7%9e%ac%e8%bf%87&#34; &gt;非常返态&lt;/a&gt;相矛盾，因此假设不成立。故 $C_n$ 中的状态 $i$ 不可到达 $D$ 中的状态 $j$ 。③证毕。定理6证毕。&lt;/p&gt;
&lt;h4 id=&#34;不可约马尔可夫链的转移&#34;&gt;不可约马尔可夫链的转移
&lt;/h4&gt;&lt;p&gt;  &lt;strong&gt;定理7&lt;/strong&gt;：周期为 $d$ 的不可约马尔可夫链，其状态空间 $S$ 可唯一地分解为 $d$ 个互不相交的子集之和，即&lt;/p&gt;
$$
S=\bigcup_{r=0}^{d-1}{S_r},\quad S_r \bigcap S_s=\varnothing,\quad r \ne S
\tag{24}
$$&lt;p&gt;  且使得自 $S_r$ 任意状态出发，经 $1$ 步转移必进入 $S_{r+1}$ 中（其中 $S_d=S_0$ ）。&lt;/p&gt;
&lt;p&gt;  &lt;strong&gt;证明（定理7）&lt;/strong&gt;：先给出子集 $S_r$ 的定义：&lt;br&gt;
  任意取状态 $i$，对每一个 $r=0,1,\cdots,d-1$ ，定义集合&lt;/p&gt;
$$
S_r=\{j\;|\;存在n \ge 0使得p_{ij}^{(nd+r)}&gt;0\}
\tag{25}
$$&lt;p&gt;  因为 $S$ 不可约，故 $S$ 中从 $i$ 出发一定可以遍历每一个状态，而 $nd+r(r=0,1,\cdots,n-1)$ 可以遍历从 $i$ 出发后的每一个时间，因此所有 $S_r$ 的并集一定为 $S$ ，即 $\displaystyle\bigcup_{r=0}^{d-1}{S_r}=S$ 。&lt;br&gt;
  接下来证明 $S_r$ 不相交。用反证法，假设存在 $S_r,S_s$ 和状态 $j$ 满足 $j \in S_r \bigcap S_s$ 。由 $S_r$ 的定义知存在 $n,m$ 使得 $p_{ij}^{(nd+r)}&amp;gt;0,p_{ij}^{(md+s)}&amp;gt;0$ 。又因为 $i \leftrightarrow j$ ，故存在 $h$ 使得 $p_{ji}^{(h)}&amp;gt;0$ ，于是由&lt;a class=&#34;link&#34; href=&#34;#c-k%e6%96%b9%e7%a8%8b&#34; &gt;C-K方程&lt;/a&gt;和和&lt;a class=&#34;link&#34; href=&#34;#%e5%ae%9a%e7%90%863&#34; &gt;(9)式的展开技巧&lt;/a&gt;可得：&lt;/p&gt;
$$
p_{ii}^{(nd+r+h)} \ge p_{ij}^{(nd+r)}p_{ji}^{(h)}&gt;0\\[5pt]
p_{ii}^{(md+s+h)} \ge p_{ij}^{(md+s)}p_{ji}^{(h)}&gt;0
\tag{26}
$$&lt;p&gt;  由&lt;a class=&#34;link&#34; href=&#34;#%e5%91%a8%e6%9c%9f&#34; &gt;周期&lt;/a&gt;的定义可知 $nd+r+h$ 和 $md+s+h$ 都可以被 $d$ 整除。省去前面的 $n$ 和 $m$ 可得 $r+h$ 和 $s+h$ 都可被 $d$ 整除。从而其差 $(r+h)-(s+h)=r-s$ 都能被 $d$ 整除(见&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“初等数论”还未上线~&#39;)&#34;&gt;整除的基本性质&lt;/a&gt;)。但是 $0 \le r \le d-1,0 \le s \le d-1$ ，故 $0 \le r-s \le d-1$ ，因此 $r-s$ 只能为 $0$ ，也就是 $r=s$ 。故 $S_r=S_s$ ，假设不成立，故 $S_r$ 不相交。&lt;br&gt;
  接下来证明自 $S_r$ 任意状态出发，经 $1$ 步转移必进入 $S_{r+1}$ 中（其中 $S_d=S_0$ ）。等价于证明对任意 $j \in S_r$ ，有 $\displaystyle\sum_{k \in S_{r+1}}{p_{jk}^{(1)}}=1$ 。事实上，由&lt;a class=&#34;link&#34; href=&#34;#%e4%b8%8d%e5%8f%af%e7%ba%a6%e9%a9%ac%e5%b0%94%e5%8f%af%e5%a4%ab%e9%93%be%e7%9a%84%e8%bd%ac%e7%a7%bb&#34; &gt; $S_r$ 的定义&lt;/a&gt;可知 $p_{ij}^{(nd+r)}&amp;gt;0$ 。而由&lt;a class=&#34;link&#34; href=&#34;#%e4%b8%8d%e5%8f%af%e7%ba%a6%e9%a9%ac%e5%b0%94%e5%8f%af%e5%a4%ab%e9%93%be%e7%9a%84%e8%bd%ac%e7%a7%bb&#34; &gt; $S_r$ 的定义&lt;/a&gt;的定义可知对 $k \notin S_{r+1}$ 必有 $p_{ik}^{(nd+r+1)}=0$ 。因此由&lt;a class=&#34;link&#34; href=&#34;#c-k%e6%96%b9%e7%a8%8b&#34; &gt;C-K方程&lt;/a&gt;和和&lt;a class=&#34;link&#34; href=&#34;#%e5%ae%9a%e7%90%863&#34; &gt;(9)式的展开技巧&lt;/a&gt;可推导：&lt;/p&gt;
$$
0=p_{ik}^{(nd+r+1)} \ge p_{ij}^{(nd+r)}p_{jk}^{(1)}&gt;0
\tag{27}
$$&lt;p&gt;  从而 $p_{jk}^{(1)}=0$ 。于是&lt;/p&gt;
$$
1\:=\sum_{k \in S}{p_{jk}}=\sum_{k \in S_{r+1}}{p_{jk}^{(1)}} + \sum_{k \notin S_{r+1}}{p_{jk}^{(1)}}=\sum_{k \in S_{r+1}}{p_{jk}^{(1)}}
\tag{28}
$$&lt;p&gt;  最后证明分解的唯一性。等价于与证明 $\{S_k\}$ 与初始的 $i$ 无关。也就是，对于任意的 $i,i^\prime$ 生成的分解 $\{S_k\},\{S_k^\prime\}$ 必相等。&lt;br&gt;
  首先，证明对于 $\{S_k\}$ 中的任意 ${S_r}$ ，存在 ${S_s^\prime}$ 与其状态完全相等。首先证对所有 $j \in S_r$ ， $j$ 都只能属于 $\{S_k^\prime\}$ 中某个固定的集合。假设 $i^{\prime}$ 满足 $i^\prime \in S_s$ 。由于自 $S_k$ 任意状态出发经 $1$ 步转移必进入 $S_{k+1}$ 中，所以当 $s \le r$ 时，从 $i^{\prime}$ 到达 $j$ 只可能通过如下过程之一：&lt;/p&gt;
$$
\begin{cases}
S_s \rightarrow S_{s+1} \rightarrow \cdots \rightarrow S_r\\
S_s \rightarrow S_{s+1} \rightarrow \cdots \rightarrow S_r\rightarrow S_{r+1} \rightarrow \cdots \rightarrow S_{d-1} \rightarrow S_0 \rightarrow S_1 \rightarrow \cdots \rightarrow S_r\\
S_s \rightarrow S_{s+1} \rightarrow \cdots \rightarrow S_r\rightarrow
\overbrace{S_{r+1} \rightarrow \cdots \rightarrow S_{d-1} \rightarrow S_0 \rightarrow S_1 \rightarrow \cdots \rightarrow S_r}^{重复2次}\\
\quad \vdots 
\end{cases}
\tag{29}
$$&lt;p&gt;  也就是从 $i^{\prime}$ 出发只能在 $r-s,r-s+d,r-s+2d,\dots$ 步上到达 $j$ 。我们发现这刚好与 $S_{r-s}^{\prime}$ 的定义是一致的。因此 $j \in S_{r-s}^{\prime}$ 。反过来讨论任意 $j^\prime \in S_{r-s}^{\prime}$ 。从 $i$ 转移到  $i^\prime$ 需要 $s$ 步，而从  $i^\prime$ 转移到  $j^\prime$ 需要 $r-s$ 步，因此从 $i$ 转移到 $j^\prime$ 需要 $r$ 步，故 $j^\prime \in S_r$ 。故 $S_r$ 与 $S_{r-s}^\prime$ 完全对等。&lt;br&gt;
  另外当 $s &amp;gt; r$ 时，由类似的方法可以证明从 $i^{\prime}$ 出发，只能在 $d-(s-r),2d-(s-r),\dots$ 步到达 $j$ ，因此 $j \in S_{d-(s-r)}^{\prime}$ 。类似的也可证明 $S_r$ 与 $S_{d-(s-r)}^{\prime}$ 完全对等。综上，有&lt;/p&gt;
$$
\begin{cases}
S_r与S_{r-s}^{\prime}完全对等，若r \ge s \\[5pt]
S_r与S_{d-(s-r)}^{\prime}完全对等，若r &lt; s
\end{cases}
\tag{30}
$$&lt;p&gt;  易证此时 $\{S_k\},\{S_k^\prime\}$ 一一对应。故分解是唯一的。&lt;/p&gt;
&lt;h2 id=&#34;极限定理与不变分布&#34;&gt;极限定理与不变分布
&lt;/h2&gt;&lt;h3 id=&#34;极限定理&#34;&gt;极限定理
&lt;/h3&gt;&lt;p&gt;  &lt;strong&gt;定理8（极限定理）&lt;/strong&gt;：若状态 $j$ 是周期为 $d$ 的常返状态，则&lt;/p&gt;
$$
\lim\limits_{n \rightarrow \infin}p_{jj}^{(nd)}=\frac{d}{\mu_j}
\tag{31}
$$&lt;p&gt;  若 $j$ 为非常返状态，则 $\lim\limits_{n \rightarrow \infin}p_{jj}^{(nd)}=0$ 。&lt;/p&gt;
&lt;p&gt;&lt;span id=&#34;(32)式&#34;&gt;&lt;/span&gt;
  &lt;strong&gt;证明（定理8）&lt;/strong&gt;：对 $n \ge 0$ ，令：&lt;/p&gt;
$$
r_n=\sum_{v=n+1}^{\infin}{f_v}
\tag{32}
$$&lt;p&gt;&lt;span id=&#34;(33)式&#34;&gt;&lt;/span&gt;
  其中 $f_v=f_{jj}^{(v)}$ 。于是&lt;/p&gt;
$$
\begin{aligned}
\sum_{n=0}^{\infin}{r_n}=&amp;\sum_{n=0}^{\infin}\sum_{v=n+1}^{\infin}{f_v}\\
=&amp;(f_1+f_2+f_3+\cdots)+(f_2+f_3+\cdots)+(f_3+\cdots)+\cdots\\[5pt]
=&amp;1\cdot f_1 + 2 \cdot f_2 + 3 \cdot f_3 + \cdots\\
=&amp;\sum_{n=1}^{\infin}{nf_n}=\mu_j
\end{aligned}
\tag{33}
$$&lt;p&gt;  由 $r_n$ 定义可知 $f_n=r_{v-1}-r_v$ ，代入&lt;a class=&#34;link&#34; href=&#34;#%e5%bc%95%e7%90%861&#34; &gt;引理1&lt;/a&gt;并记 $p_v=p_{jj}^{(v)}$ 可得&lt;/p&gt;
$$
p_n=p_{jj}^{(n)}=\sum_{l=1}^{n}{f_{jj}^{(l)}p_{jj}^{(n-l)}}=-\sum_{v=1}^{n}{(r_v-r_{v-1})p_{n-v}}
\tag{34}
$$&lt;p&gt;  注意 $j$ 是常返状态，故 $r_0=1$。则上式可以写成&lt;/p&gt;
$$
\sum_{v=0}^{n}{r_vp_{n-v}}=\sum_{v=0}^{n-1}r_vp_{n-1-v}
\tag{35}
$$&lt;p&gt;&lt;span id=&#34;(36)式&#34;&gt;&lt;/span&gt;
  上面这个式子表示了一个很明显的结论： $\displaystyle\sum_{v=0}^{n}{r_vp_{n-v}}$ 的值与 $n$ 无关。因此：&lt;/p&gt;
$$
\sum_{v=0}^{n}{r_vp_{n-v}}=r_0p_0=1,\quad n \ge 0
\tag{36}
$$&lt;p&gt;&lt;span id=&#34;(37)式&#34;&gt;&lt;/span&gt;
  设&lt;/p&gt;
$$
\lambda=\limsup\limits_{n \rightarrow \infin}p_{nd}
\tag{37}
$$&lt;p&gt;&lt;span id=&#34;(38)式&#34;&gt;&lt;/span&gt;
  根据&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“数学分析”还未上线~&#39;)&#34;&gt;上极限的定义&lt;/a&gt;可知，必然存在 $\{n\}$ 的子列 $\{n_m\},n_m \rightarrow \infin$ 使得&lt;/p&gt;
$$
\lambda=\lim\limits_{m \rightarrow \infin}{p_{n_md}}=\limsup\limits_{m \rightarrow \infin}{p_{n_md}}=\liminf\limits_{m \rightarrow \infin}{p_{n_md}}
\tag{38}
$$&lt;p&gt;&lt;span id=&#34;(39)式&#34;&gt;&lt;/span&gt;
  任取 $s$ 使得 $f_s&amp;gt;0$ ，由&lt;a class=&#34;link&#34; href=&#34;#%e5%bc%95%e7%90%861&#34; &gt;引理1&lt;/a&gt;和&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“数学分析”还未上线~&#39;)&#34;&gt;下极限的性质&lt;/a&gt;可得&lt;/p&gt;
$$
\begin{aligned}
\lambda=&amp;\liminf\limits_{m \rightarrow \infin}p_{n_md}=\liminf\limits_{m \rightarrow \infin}p_{jj}^{(n_md)}=\liminf\limits_{m \rightarrow \infin}\sum_{v=1}^{n_md}f_{jj}^{(v)}p_{jj}^{(n_md-v)}\\
=&amp;\liminf\limits_{m \rightarrow \infin}\sum_{v=1}^{n_md}f_{v}p_{n_md-v}=\liminf\limits_{m \rightarrow \infin}\bigg(f_sp_{n_md-s}+\sum_{v=1,v \ne s}^{n_md}f_{v}p_{n_md-v}\bigg)\\
\le&amp;\liminf\limits_{m \rightarrow \infin}f_sp_{n_md-s}+\liminf\limits_{m \rightarrow \infin}\sum_{v=1,v \ne s}^{n_md}f_{v}p_{n_md-v}\quad\text{（}\liminf\limits_{n \rightarrow \infin}(a_n+b_n)\le\liminf\limits_{n \rightarrow \infin}a_n+\liminf\limits_{n \rightarrow \infin}b_n\text{）}
\end{aligned}
\tag{39}
$$&lt;p&gt;&lt;span id=&#34;(40)式&#34;&gt;&lt;/span&gt;
  由&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“概率论”还未上线~&#39;)&#34;&gt;概率的非负性&lt;/a&gt;和&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“数学分析”还未上线~&#39;)&#34;&gt;上下极限的性质&lt;/a&gt;和可推导出&lt;/p&gt;
$$
\begin{aligned}
\liminf\limits_{m \rightarrow \infin}\sum_{v=1,v \ne s}^{n_md}f_{v}p_{n_md-v}\le&amp;\sum_{v=1,v \ne s}^{n_md}\liminf\limits_{m \rightarrow \infin}f_{v}p_{n_md-v}\quad\text{（}\liminf\limits_{n \rightarrow \infin}(a_n+b_n)\le\liminf\limits_{n \rightarrow \infin}a_n+\liminf\limits_{n \rightarrow \infin}b_n\text{）}\\
\le&amp;\sum_{v=1,v \ne s}^{\infin}\liminf\limits_{m \rightarrow \infin}f_{v}p_{n_md-v}\quad\text{（概率的非负性）}\\
\le&amp;\sum_{v=1,v \ne s}^{\infin}\liminf\limits_{m \rightarrow \infin}f_{v}\limsup\limits_{m \rightarrow \infin}p_{n_md-v}\quad\text{（}\liminf\limits_{n \rightarrow \infin}a_nb_n\le\liminf\limits_{n \rightarrow \infin}a_n\limsup\limits_{n \rightarrow \infin}b_n\text{）}\\
=&amp;\sum_{v=1,v \ne s}^{\infin}f_{v}\limsup\limits_{m \rightarrow \infin}p_{n_md-v}\\
\end{aligned}
\tag{40}
$$&lt;p&gt;&lt;span id=&#34;(41)式&#34;&gt;&lt;/span&gt;
  注意当 $v$ 不是 $d$ 的倍数时 $p_{n_md-v}=0$ ，此时 $\limsup\limits_{m \rightarrow \infin}p_{n_md-v} \le \limsup\limits_{m \rightarrow \infin}p_{n_md}$ ；若 $v$ 是 $d$ 的倍数，由&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“数学分析”还未上线~&#39;)&#34;&gt;上极限的性质&lt;/a&gt;可知仍有  $\limsup\limits_{m \rightarrow \infin}p_{n_md-v} \le \limsup\limits_{m \rightarrow \infin}p_{n_md}$ 。故接&lt;a class=&#34;link&#34; href=&#34;#%2840%29%e5%bc%8f&#34; &gt;(40)式&lt;/a&gt;&lt;/p&gt;
$$
\liminf\limits_{m \rightarrow \infin}\sum_{v=1,v \ne s}^{n_md}f_{v}p_{n_md-v}=\sum_{v=1,v \ne s}^{\infin}f_{v}\limsup\limits_{m \rightarrow \infin}p_{n_md-v}\le\bigg(\sum_{v=1,v \ne s}^{\infin}f_{v}\bigg)\limsup\limits_{m \rightarrow \infin}p_{n_md}
\tag{41}
$$&lt;p&gt;  注意状态 $j$ 是&lt;a class=&#34;link&#34; href=&#34;#%e5%b8%b8%e8%bf%94&#34; &gt;常返&lt;/a&gt;的，所以 $\displaystyle\sum_{v=1}^{\infin}f_{v}=1$ ，也就是 $\displaystyle\sum_{v=1,v \ne s}^{\infin}f_{v}=1-f_s$ 。而将&lt;a class=&#34;link&#34; href=&#34;#%2838%29%e5%bc%8f&#34; &gt;(38)式&lt;/a&gt; 代入&lt;a class=&#34;link&#34; href=&#34;#%2841%29%e5%bc%8f&#34; &gt;(41)式&lt;/a&gt;后再将&lt;a class=&#34;link&#34; href=&#34;#%2841%29%e5%bc%8f&#34; &gt;(41)式&lt;/a&gt;代回&lt;a class=&#34;link&#34; href=&#34;#%2839%29%e5%bc%8f&#34; &gt;(39)式&lt;/a&gt;得&lt;/p&gt;
$$
\lambda\le f_s\liminf\limits_{m \rightarrow \infin}p_{n_md-s}+(1-f_s)\lambda
\tag{42}
$$&lt;p&gt;即&lt;/p&gt;
$$
\liminf\limits_{m \rightarrow \infin}p_{n_md-s}\ge\lambda
\tag{43}
$$&lt;p&gt;&lt;span id=&#34;44式&#34;&gt;&lt;/span&gt;
  由&lt;a class=&#34;link&#34; href=&#34;#%e5%91%a8%e6%9c%9f&#34; &gt;周期&lt;/a&gt;的定义和 $f_s&amp;gt;0$ 知 $d$ 必整除 $s$ 。因此 $\limsup\limits_{m \rightarrow \infin}p_{n_md-s}=\limsup\limits_{m \rightarrow \infin}p_{n_md}=\lambda$ 。但是由&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“数学分析”还未上线~&#39;)&#34;&gt;上下极限的定义&lt;/a&gt;可知 $\limsup\limits_{m \rightarrow \infin}p_{n_md-s}\ge\liminf\limits_{m \rightarrow \infin}p_{n_md-s}$ ，即 $\lambda=\limsup\limits_{m \rightarrow \infin}p_{n_md-s}\ge\liminf\limits_{m \rightarrow \infin}p_{n_md-s}\ge\lambda$ 。故由&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“数学分析”还未上线~&#39;)&#34;&gt;夹挤准则&lt;/a&gt;可知 $\limsup\limits_{m \rightarrow \infin}p_{n_md-s}=\liminf\limits_{m \rightarrow \infin}p_{n_md-s}=\lim\limits_{m \rightarrow \infin}p_{n_md-s}=\lambda$ 。又由&lt;a class=&#34;link&#34; href=&#34;#39%e5%bc%8f&#34; &gt;(39)式&lt;/a&gt;可得：&lt;/p&gt;
$$
\lambda=\lim\limits_{m \rightarrow \infin}p_{n_md}=\lim\limits_{m \rightarrow \infin}p_{n_md-s}=\lim\limits_{m \rightarrow \infin}p_{n_md-2s}=\cdots
\tag{44}
$$&lt;p&gt;&lt;span id=&#34;45式&#34;&gt;&lt;/span&gt;
  任取 $l$ 个正整数 $c_i$ 和满足 $f_{d_i}&amp;gt;0$ 的 $l$ 个正整数 $d_i,i=1,2,\cdots,l$ 。由&lt;a class=&#34;link&#34; href=&#34;#44%e5%bc%8f&#34; &gt;(44)式&lt;/a&gt;可知有&lt;/p&gt;
$$
\lim\limits_{m \rightarrow \infin}p_{n_md-c_id_i}=\lambda
\tag{45}
$$&lt;p&gt;&lt;span id=&#34;46式&#34;&gt;&lt;/span&gt;
  注意由&lt;a class=&#34;link&#34; href=&#34;#%e5%91%a8%e6%9c%9f&#34; &gt;周期&lt;/a&gt;的定义，$d$ 一定可以整除 $d_i$ 。假设 $d_i=k_id$ ， $k_i$ 为正整数，则&lt;a class=&#34;link&#34; href=&#34;#45%e5%bc%8f&#34; &gt;(45)式&lt;/a&gt;又可以写为&lt;/p&gt;
$$
\lim\limits_{m \rightarrow \infin}p_{(n_m-c_ik_i)d}=\lambda
\tag{46}
$$&lt;p&gt;&lt;span id=&#34;47式&#34;&gt;&lt;/span&gt;
  可以定义一个正整数 $n_m^\prime=n_m-c_ik_i$ 。则&lt;a class=&#34;link&#34; href=&#34;#46%e5%bc%8f&#34; &gt;(46)式&lt;/a&gt;可以写成&lt;/p&gt;
$$
\lim\limits_{m \rightarrow \infin}p_{n_m^\prime d}=\lambda
\tag{47}
$$&lt;p&gt;  我们发现&lt;a class=&#34;link&#34; href=&#34;#47%e5%bc%8f&#34; &gt;(47)式&lt;/a&gt;和&lt;a class=&#34;link&#34; href=&#34;#39%e5%bc%8f&#34; &gt;(39)式&lt;/a&gt;形式完全一样，因此再次重复从&lt;a class=&#34;link&#34; href=&#34;#39%e5%bc%8f&#34; &gt;(39)式&lt;/a&gt;到&lt;a class=&#34;link&#34; href=&#34;#44%e5%bc%8f&#34; &gt;(44)式&lt;/a&gt;的推导又可以得到&lt;/p&gt;
$$
\lambda=\lim\limits_{m \rightarrow \infin}p_{n_m^\prime d}=\lim\limits_{m \rightarrow \infin}p_{n_m^\prime d-s^\prime}=\lim\limits_{m \rightarrow \infin}p_{n_m^\prime d-2s^\prime}=\cdots
\tag{48}
$$&lt;p&gt;  也就是&lt;/p&gt;
$$
\lim\limits_{m \rightarrow \infin}p_{n_m^\prime d-c_{i^\prime}d_{i^\prime}}=\lambda
\tag{49}
$$&lt;p&gt;  因此，不同的 $c_id_i$ 可以叠加而不影响结论。故对 $u=\displaystyle\sum_{i=1}^{l}c_id_i$ 也满足&lt;/p&gt;
$$
\lim\limits_{m \rightarrow \infin}p_{n_md-u}=\lambda
\tag{50}
$$&lt;p&gt;  由&lt;a class=&#34;link&#34; href=&#34;#%e5%91%a8%e6%9c%9f&#34; &gt;周期 $d$ 的定义&lt;/a&gt;知，存在满足 $f_{d_i}&amp;gt;0$ 的 $d_i,i=1,2,\cdots,l$ 使得 $d_1,d_2,\cdots,d_l$ 的最大公因子也是 $d$ 。于是，当 $k$ 大于某个正整数 $k_0$ 时，必有正整数 $c_i$ ，使得&lt;/p&gt;
$$
kd=\sum_{i=1}^{l}c_id_i
\tag{51}
 $$&lt;p&gt;  上述结论见&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，初等数论还未上线~&#39;)&#34;&gt;Frobenius问题&lt;/a&gt;（实际上 $k_0$ 就是数论中著名的Frobenius数，该数在 $l\ge3$ 时无一般表示式，但是可以证明 $k_0\le \displaystyle\sum_{i=2}^{n}\frac{d_i\cdot gcd(d_1,d_2,\dots,d_{i-1})}{d \cdot gcd(d_1,d_2,\dots,d_i)} - \displaystyle\sum_{i=1}^{n}\frac{d_i}{d}$ ）。于是，对每一个 $k\ge k_0$ 有&lt;/p&gt;
$$
\lim\limits_{n \rightarrow \infin}p_{(n_m-k)d}=\lambda
\tag{52}
$$&lt;p&gt;  在&lt;a class=&#34;link&#34; href=&#34;#%2836%29%e5%bc%8f&#34; &gt;(36)式&lt;/a&gt;中令 $n=(n_m-k_0)d$， 并注意到 $v$ 不是 $d$ 的整数倍时 $p_v=0$ ，故可把 $v$ 替换为 $vd$ ，则得&lt;/p&gt;
$$
\sum_{v=0}^{n_m-k_0}r_{vd}p_{(n_m-k_0-v)d}=1
\tag{53}
$$&lt;p&gt;&lt;span id=&#34;(54)式&#34;&gt;&lt;/span&gt;
  令 $m \rightarrow \infin$ 可得&lt;/p&gt;
$$
\lambda=\frac{1}{\displaystyle\sum_{v=0}^{\infin}r_{vd}}
\tag{54}
$$&lt;p&gt;  因为当 $v$ 不是 $d$ 的整数倍时，$f_v=0$ ，由&lt;a class=&#34;link&#34; href=&#34;#%2832%29%e5%bc%8f&#34; &gt;(32)式&lt;/a&gt;可得&lt;/p&gt;
$$
r_{vd} = r_{vd+1} = \cdots = r_{vd+d-1} = \frac{1}{d}\sum_{j=vd}^{vd+d-1}r_j
\tag{55}
$$&lt;p&gt;  从而由&lt;a class=&#34;link&#34; href=&#34;#%2833%29%e5%bc%8f&#34; &gt;(33)式&lt;/a&gt;得&lt;/p&gt;
$$
\sum_{v=0}^{\infin}r_{vd}=\frac{1}{d}\sum_{v=0}^{\infin}\sum_{j=vd}^{vd+d-1}r_j=\frac{1}{d}\sum_{v=0}^{\infin}r_v=\frac{\mu_j}{d}
\tag{56}
$$&lt;p&gt;  代入&lt;a class=&#34;link&#34; href=&#34;#%2854%29%e5%bc%8f&#34; &gt;(54)式&lt;/a&gt;可得&lt;/p&gt;
$$
\lambda = \frac{d}{\mu_j}
\tag{57}
$$&lt;p&gt;  把&lt;a class=&#34;link&#34; href=&#34;#%2837%29%e5%bc%8f&#34; &gt;(37)式&lt;/a&gt;换成 $\lambda=\liminf\limits_{n \rightarrow \infin}p_{nd}$ ，下面的推导过程完全相同，仍可以得到 $\lambda = \displaystyle\frac{d}{\mu_j}$ 。因此，由&lt;a class=&#34;link&#34; onclick=&#34;alert(&#39;抱歉，“数学分析”还未上线~&#39;)&#34;&gt;极限的性质&lt;/a&gt;可知&lt;/p&gt;
$$
\lim\limits_{n \rightarrow \infin}p_{nd}=\frac{d}{\mu_j}
\tag{58}
$$&lt;p&gt;  当 $j$ 为非常返状态时 $\mu_j \rightarrow \infin$ ，因此 $\lim\limits_{n \rightarrow \infin}p_{nd}=0$ 。&lt;a class=&#34;link&#34; href=&#34;#%e6%9e%81%e9%99%90%e5%ae%9a%e7%90%86&#34; &gt;定理8&lt;/a&gt;证毕。&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
